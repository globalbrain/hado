import{patchGlobal}from"npm:@brc-dd/globals@^0.1.0";const DEBUG_BUILD$1="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,SDK_VERSION="8.50.0",GLOBAL_OBJ=globalThis;function getGlobalSingleton(e,t,n){const r=GLOBAL_OBJ,s=r.__SENTRY__=r.__SENTRY__||{},o=s["8.50.0"]=s["8.50.0"]||{};return o[e]||(o[e]=t())}const DEBUG_BUILD="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,PREFIX="Sentry Logger ",CONSOLE_LEVELS=["debug","info","warn","error","log","assert","trace"],originalConsoleMethods={};function consoleSandbox(e){if(!("console"in GLOBAL_OBJ))return e();const t=GLOBAL_OBJ.console,n={},r=Object.keys(originalConsoleMethods);r.forEach((e=>{const r=originalConsoleMethods[e];n[e]=t[e],t[e]=r}));try{return e()}finally{r.forEach((e=>{t[e]=n[e]}))}}function makeLogger(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return DEBUG_BUILD?CONSOLE_LEVELS.forEach((n=>{t[n]=(...t)=>{e&&consoleSandbox((()=>{GLOBAL_OBJ.console[n](`${PREFIX}[${n}]:`,...t)}))}})):CONSOLE_LEVELS.forEach((e=>{t[e]=()=>{}})),t}const logger=getGlobalSingleton("logger",makeLogger),STACKTRACE_FRAME_LIMIT=50,UNKNOWN_FUNCTION="?",WEBPACK_ERROR_REGEXP=/\(error: (.*)\)/,STRIP_FRAME_REGEXP=/captureMessage|captureException/;function createStackParser(...e){const t=e.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]));return(e,n=0,r=0)=>{const s=[],o=e.split("\n");for(let e=n;e<o.length;e++){const n=o[e];if(n.length>1024)continue;const i=WEBPACK_ERROR_REGEXP.test(n)?n.replace(WEBPACK_ERROR_REGEXP,"$1"):n;if(!i.match(/\S*Error: /)){for(const e of t){const t=e(i);if(t){s.push(t);break}}if(s.length>=50+r)break}}return stripSentryFramesAndReverse(s.slice(r))}}function stackParserFromStackParserOptions(e){return Array.isArray(e)?createStackParser(...e):e}function stripSentryFramesAndReverse(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(getLastStackFrame(t).function||"")&&t.pop(),t.reverse(),STRIP_FRAME_REGEXP.test(getLastStackFrame(t).function||"")&&(t.pop(),STRIP_FRAME_REGEXP.test(getLastStackFrame(t).function||"")&&t.pop()),t.slice(0,50).map((e=>({...e,filename:e.filename||getLastStackFrame(t).filename,function:e.function||"?"})))}function getLastStackFrame(e){return e[e.length-1]||{}}const defaultFunctionName="<anonymous>";function getFunctionName(e){try{return e&&"function"==typeof e&&e.name||"<anonymous>"}catch(e){return"<anonymous>"}}function getFramesFromEvent(e){const t=e.exception;if(t){const e=[];try{return t.values.forEach((t=>{t.stacktrace.frames&&e.push(...t.stacktrace.frames)})),e}catch(e){return}}}const handlers={},instrumented={};function addHandler(e,t){handlers[e]=handlers[e]||[],handlers[e].push(t)}function maybeInstrument(e,t){if(!instrumented[e]){instrumented[e]=!0;try{t()}catch(t){DEBUG_BUILD&&logger.error(`Error while instrumenting ${e}`,t)}}}function triggerHandlers(e,t){const n=e&&handlers[e];if(n)for(const r of n)try{r(t)}catch(t){DEBUG_BUILD&&logger.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${getFunctionName(r)}\nError:`,t)}}let _oldOnErrorHandler=null;function addGlobalErrorInstrumentationHandler(e){const t="error";addHandler(t,e),maybeInstrument(t,instrumentError)}function instrumentError(){_oldOnErrorHandler=GLOBAL_OBJ.onerror,GLOBAL_OBJ.onerror=function(e,t,n,r,s){return triggerHandlers("error",{column:r,error:s,line:n,msg:e,url:t}),!!_oldOnErrorHandler&&_oldOnErrorHandler.apply(this,arguments)},GLOBAL_OBJ.onerror.__SENTRY_INSTRUMENTED__=!0}let _oldOnUnhandledRejectionHandler=null;function addGlobalUnhandledRejectionInstrumentationHandler(e){const t="unhandledrejection";addHandler(t,e),maybeInstrument(t,instrumentUnhandledRejection)}function instrumentUnhandledRejection(){_oldOnUnhandledRejectionHandler=GLOBAL_OBJ.onunhandledrejection,GLOBAL_OBJ.onunhandledrejection=function(e){return triggerHandlers("unhandledrejection",e),!_oldOnUnhandledRejectionHandler||_oldOnUnhandledRejectionHandler.apply(this,arguments)},GLOBAL_OBJ.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function getMainCarrier(){return getSentryCarrier(GLOBAL_OBJ),GLOBAL_OBJ}function getSentryCarrier(e){const t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||"8.50.0",t["8.50.0"]=t["8.50.0"]||{}}const objectToString=Object.prototype.toString;function isError(e){switch(objectToString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return isInstanceOf(e,Error)}}function isBuiltin(e,t){return objectToString.call(e)===`[object ${t}]`}function isErrorEvent$1(e){return isBuiltin(e,"ErrorEvent")}function isString(e){return isBuiltin(e,"String")}function isParameterizedString(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function isPrimitive(e){return null===e||isParameterizedString(e)||"object"!=typeof e&&"function"!=typeof e}function isPlainObject(e){return isBuiltin(e,"Object")}function isEvent(e){return"undefined"!=typeof Event&&isInstanceOf(e,Event)}function isElement(e){return"undefined"!=typeof Element&&isInstanceOf(e,Element)}function isRegExp(e){return isBuiltin(e,"RegExp")}function isThenable(e){return Boolean(e&&e.then&&"function"==typeof e.then)}function isSyntheticEvent(e){return isPlainObject(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function isInstanceOf(e,t){try{return e instanceof t}catch(e){return!1}}function isVueViewModel(e){return!("object"!=typeof e||null===e||!e.__isVue&&!e._isVue)}const WINDOW$1=GLOBAL_OBJ,DEFAULT_MAX_STRING_LENGTH=80;function htmlTreeAsString(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,s=[];let o=0,i=0;const a=" > ",c=a.length;let u;const l=Array.isArray(t)?t:t.keyAttrs,p=!Array.isArray(t)&&t.maxStringLength||80;for(;n&&o++<r&&(u=_htmlElementAsString(n,l),!("html"===u||o>1&&i+s.length*c+u.length>=p));)s.push(u),i+=u.length,n=n.parentNode;return s.reverse().join(a)}catch(e){return"<unknown>"}}function _htmlElementAsString(e,t){const n=e,r=[];if(!n||!n.tagName)return"";if(WINDOW$1.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=t&&t.length?t.filter((e=>n.getAttribute(e))).map((e=>[e,n.getAttribute(e)])):null;if(s&&s.length)s.forEach((e=>{r.push(`[${e[0]}="${e[1]}"]`)}));else{n.id&&r.push(`#${n.id}`);const e=n.className;if(e&&isString(e)){const t=e.split(/\s+/);for(const e of t)r.push(`.${e}`)}}const o=["aria-label","type","name","title","alt"];for(const e of o){const t=n.getAttribute(e);t&&r.push(`[${e}="${t}"]`)}return r.join("")}function truncate(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function snipLine(e,t){let n=e;const r=n.length;if(r<=150)return n;t>r&&(t=r);let s=Math.max(t-60,0);s<5&&(s=0);let o=Math.min(s+140,r);return o>r-5&&(o=r),o===r&&(s=Math.max(o-140,0)),n=n.slice(s,o),s>0&&(n=`'{snip} ${n}`),o<r&&(n+=" {snip}"),n}function safeJoin(e,t){if(!Array.isArray(e))return"";const n=[];for(let t=0;t<e.length;t++){const r=e[t];try{isVueViewModel(r)?n.push("[VueViewModel]"):n.push(String(r))}catch(e){n.push("[value cannot be serialized]")}}return n.join(t)}function isMatchingPattern(e,t,n=!1){return!!isString(e)&&(isRegExp(t)?t.test(e):!!isString(t)&&(n?e===t:e.includes(t)))}function stringMatchesSomePattern(e,t=[],n=!1){return t.some((t=>isMatchingPattern(e,t,n)))}function fill(e,t,n){function r(e){if(!(t in e))return;const r=e[t],s=n(r);"function"==typeof s&&markFunctionWrapped(s,r);try{e[t]=s}catch(n){DEBUG_BUILD&&logger.log(`Failed to replace method "${t}" in object`,e,n)}return e}let s=Object.prototype.toString.call(e);s="[object console]"===s?"console":"[object Window]"===s?"globalThis":void 0,s?patchGlobal(s,r):r(e)}function addNonEnumerableProperty(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch(n){DEBUG_BUILD&&logger.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function markFunctionWrapped(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,addNonEnumerableProperty(e,"__sentry_original__",t)}catch(e){}}function getOriginalFunction(e){return e.__sentry_original__}function convertToPlainObject(e){if(isError(e))return{message:e.message,name:e.name,stack:e.stack,...getOwnProperties(e)};if(isEvent(e)){const t={type:e.type,target:serializeEventTarget(e.target),currentTarget:serializeEventTarget(e.currentTarget),...getOwnProperties(e)};return"undefined"!=typeof CustomEvent&&isInstanceOf(e,CustomEvent)&&(t.detail=e.detail),t}return e}function serializeEventTarget(e){try{return isElement(e)?htmlTreeAsString(e):Object.prototype.toString.call(e)}catch(e){return"<unknown>"}}function getOwnProperties(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function extractExceptionKeysForMessage(e,t=40){const n=Object.keys(convertToPlainObject(e));n.sort();const r=n[0];if(!r)return"[object has no keys]";if(r.length>=t)return truncate(r,t);for(let e=n.length;e>0;e--){const r=n.slice(0,e).join(", ");if(!(r.length>t))return e===n.length?r:truncate(r,t)}return""}function dropUndefinedKeys(e){return _dropUndefinedKeys(e,new Map)}function _dropUndefinedKeys(e,t){if(isPojo(e)){const n=t.get(e);if(void 0!==n)return n;const r={};t.set(e,r);for(const n of Object.getOwnPropertyNames(e))void 0!==e[n]&&(r[n]=_dropUndefinedKeys(e[n],t));return r}if(Array.isArray(e)){const n=t.get(e);if(void 0!==n)return n;const r=[];return t.set(e,r),e.forEach((e=>{r.push(_dropUndefinedKeys(e,t))})),r}return e}function isPojo(e){if(!isPlainObject(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||"Object"===t}catch(e){return!0}}const ONE_SECOND_IN_MS=1e3;function dateTimestampInSeconds(){return Date.now()/1e3}function createUnixTimestampInSecondsFunc(){const{performance:e}=GLOBAL_OBJ;if(!e||!e.now)return dateTimestampInSeconds;const t=Date.now()-e.now(),n=null==e.timeOrigin?t:e.timeOrigin;return()=>(n+e.now())/1e3}const timestampInSeconds=createUnixTimestampInSecondsFunc();function uuid4(){const e=GLOBAL_OBJ,t=e.crypto||e.msCrypto;let n=()=>16*Math.random();try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(n=()=>{const e=new Uint8Array(1);return t.getRandomValues(e),e[0]})}catch(e){}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&n())>>e/4).toString(16)))}function getFirstException(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function getEventDescription(e){const{message:t,event_id:n}=e;if(t)return t;const r=getFirstException(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function addExceptionTypeValue(e,t,n){const r=e.exception=e.exception||{},s=r.values=r.values||[],o=s[0]=s[0]||{};o.value||(o.value=""),o.type||(o.type="Error")}function addExceptionMechanism(e,t){const n=getFirstException(e);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){const e={...r&&r.data,...t.data};n.mechanism.data=e}}function addContextToFrame(e,t,n=5){if(void 0===t.lineno)return;const r=e.length,s=Math.max(Math.min(r-1,t.lineno-1),0);t.pre_context=e.slice(Math.max(0,s-n),s).map((e=>snipLine(e,0)));const o=Math.min(r-1,s);t.context_line=snipLine(e[o],t.colno||0),t.post_context=e.slice(Math.min(s+1,r),s+1+n).map((e=>snipLine(e,0)))}function checkOrSetAlreadyCaught(e){if(isAlreadyCaptured(e))return!0;try{addNonEnumerableProperty(e,"__sentry_captured__",!0)}catch(e){}return!1}function isAlreadyCaptured(e){try{return e.__sentry_captured__}catch(e){}}var States;function resolvedSyncPromise(e){return new SyncPromise((t=>{t(e)}))}function rejectedSyncPromise(e){return new SyncPromise(((t,n)=>{n(e)}))}(()=>{const{performance:e}=GLOBAL_OBJ;if(!e||!e.now)return;const t=36e5,n=e.now(),r=Date.now(),s=e.timeOrigin?Math.abs(e.timeOrigin+n-r):t,o=s<t,i=e.timing&&e.timing.navigationStart,a="number"==typeof i?Math.abs(i+n-r):t;(o||a<t)&&(s<=a&&e.timeOrigin)})(),function(e){e[e.PENDING=0]="PENDING";e[e.RESOLVED=1]="RESOLVED";e[e.REJECTED=2]="REJECTED"}(States||(States={}));class SyncPromise{constructor(e){SyncPromise.prototype.__init.call(this),SyncPromise.prototype.__init2.call(this),SyncPromise.prototype.__init3.call(this),SyncPromise.prototype.__init4.call(this),this._state=States.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}then(e,t){return new SyncPromise(((n,r)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){r(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){r(e)}else r(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new SyncPromise(((t,n)=>{let r,s;return this.then((t=>{s=!1,r=t,e&&e()}),(t=>{s=!0,r=t,e&&e()})).then((()=>{s?n(r):t(r)}))}))}__init(){this._resolve=e=>{this._setResult(States.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(States.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===States.PENDING&&(isThenable(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===States.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(this._state===States.RESOLVED&&e[1](this._value),this._state===States.REJECTED&&e[2](this._value),e[0]=!0)}))}}}function makeSession(e){const t=timestampInSeconds(),n={sid:uuid4(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>sessionToJSON(n)};return e&&updateSession(n,e),n}function updateSession(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||timestampInSeconds(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:uuid4()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function closeSession(e,t){let n={};"ok"===e.status&&(n={status:"exited"}),updateSession(e,n)}function sessionToJSON(e){return dropUndefinedKeys({sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}function generateTraceId(){return uuid4()}function generateSpanId(){return uuid4().substring(16)}function merge(e,t,n=2){if(!t||"object"!=typeof t||n<=0)return t;if(e&&t&&0===Object.keys(t).length)return e;const r={...e};for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=merge(r[e],t[e],n-1));return r}const SCOPE_SPAN_FIELD="_sentrySpan";function _setSpanForScope(e,t){t?addNonEnumerableProperty(e,"_sentrySpan",t):delete e._sentrySpan}function _getSpanForScope(e){return e._sentrySpan}const DEFAULT_MAX_BREADCRUMBS=100;class ScopeClass{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:generateTraceId(),spanId:generateSpanId()}}clone(){const e=new ScopeClass;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,_setSpanForScope(e,_getSpanForScope(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&updateSession(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t="function"==typeof e?e(this):e,[n,r]=t instanceof Scope?[t.getScopeData(),t.getRequestSession()]:isPlainObject(t)?[e,e.requestSession]:[],{tags:s,extra:o,user:i,contexts:a,level:c,fingerprint:u=[],propagationContext:l}=n||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...o},this._contexts={...this._contexts,...a},i&&Object.keys(i).length&&(this._user=i),c&&(this._level=c),u.length&&(this._fingerprint=u),l&&(this._propagationContext=l),r&&(this._requestSession=r),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,_setSpanForScope(this,void 0),this._attachments=[],this.setPropagationContext({traceId:generateTraceId()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const r={timestamp:dateTimestampInSeconds(),...e},s=this._breadcrumbs;return s.push(r),this._breadcrumbs=s.length>n?s.slice(-n):s,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:_getSpanForScope(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=merge(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext={spanId:generateSpanId(),...e},this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t&&t.event_id?t.event_id:uuid4();if(!this._client)return logger.warn("No client configured on scope - will not capture exception!"),n;const r=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...t,event_id:n},this),n}captureMessage(e,t,n){const r=n&&n.event_id?n.event_id:uuid4();if(!this._client)return logger.warn("No client configured on scope - will not capture message!"),r;const s=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:s,...n,event_id:r},this),r}captureEvent(e,t){const n=t&&t.event_id?t.event_id:uuid4();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(logger.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}}const Scope=ScopeClass;function getDefaultCurrentScope(){return getGlobalSingleton("defaultCurrentScope",(()=>new Scope))}function getDefaultIsolationScope(){return getGlobalSingleton("defaultIsolationScope",(()=>new Scope))}class AsyncContextStack{constructor(e,t){let n,r;n=e||new Scope,r=t||new Scope,this._stack=[{scope:n}],this._isolationScope=r}withScope(e){const t=this._pushScope();let n;try{n=e(t)}catch(e){throw this._popScope(),e}return isThenable(n)?n.then((e=>(this._popScope(),e)),(e=>{throw this._popScope(),e})):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function getAsyncContextStack(){const e=getSentryCarrier(getMainCarrier());return e.stack=e.stack||new AsyncContextStack(getDefaultCurrentScope(),getDefaultIsolationScope())}function withScope$1(e){return getAsyncContextStack().withScope(e)}function withSetScope(e,t){const n=getAsyncContextStack();return n.withScope((()=>(n.getStackTop().scope=e,t(e))))}function withIsolationScope$1(e){return getAsyncContextStack().withScope((()=>e(getAsyncContextStack().getIsolationScope())))}function getStackAsyncContextStrategy(){return{withIsolationScope:withIsolationScope$1,withScope:withScope$1,withSetScope:withSetScope,withSetIsolationScope:(e,t)=>withIsolationScope$1(t),getCurrentScope:()=>getAsyncContextStack().getScope(),getIsolationScope:()=>getAsyncContextStack().getIsolationScope()}}function getAsyncContextStrategy(e){const t=getSentryCarrier(e);return t.acs?t.acs:getStackAsyncContextStrategy()}function getCurrentScope(){return getAsyncContextStrategy(getMainCarrier()).getCurrentScope()}function getIsolationScope(){return getAsyncContextStrategy(getMainCarrier()).getIsolationScope()}function getGlobalScope(){return getGlobalSingleton("globalScope",(()=>new Scope))}function withScope(...e){const t=getAsyncContextStrategy(getMainCarrier());if(2===e.length){const[n,r]=e;return n?t.withSetScope(n,r):t.withScope(r)}return t.withScope(e[0])}function withIsolationScope(...e){const t=getAsyncContextStrategy(getMainCarrier());if(2===e.length){const[n,r]=e;return n?t.withSetIsolationScope(n,r):t.withIsolationScope(r)}return t.withIsolationScope(e[0])}function getClient(){return getCurrentScope().getClient()}function getTraceContextFromScope(e){const t=e.getPropagationContext(),{traceId:n,spanId:r,parentSpanId:s}=t;return dropUndefinedKeys({trace_id:n,span_id:r,parent_span_id:s})}const METRICS_SPAN_FIELD="_sentryMetrics";function getMetricSummaryJsonForSpan(e){const t=e._sentryMetrics;if(!t)return;const n={};for(const[,[e,r]]of t){(n[e]||(n[e]=[])).push(dropUndefinedKeys(r))}return n}function updateMetricSummaryOnSpan(e,t,n,r,s,o,i){const a=e._sentryMetrics||(e._sentryMetrics=new Map),c=`${t}:${n}@${s}`,u=a.get(i);if(u){const[,e]=u;a.set(i,[c,{min:Math.min(e.min,r),max:Math.max(e.max,r),count:e.count+=1,sum:e.sum+=r,tags:e.tags}])}else a.set(i,[c,{min:r,max:r,count:1,sum:r,tags:o}])}const SEMANTIC_ATTRIBUTE_SENTRY_SOURCE="sentry.source",SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE="sentry.sample_rate",SEMANTIC_ATTRIBUTE_SENTRY_OP="sentry.op",SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN="sentry.origin",SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT="sentry.measurement_unit",SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE="sentry.measurement_value",SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME="sentry.custom_span_name",SEMANTIC_ATTRIBUTE_PROFILE_ID="sentry.profile_id",SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME="sentry.exclusive_time",SPAN_STATUS_UNSET=0,SPAN_STATUS_OK=1,SPAN_STATUS_ERROR=2;function getSpanStatusFromHttpCode(e){if(e<400&&e>=100)return{code:1};if(e>=400&&e<500)switch(e){case 401:return{code:2,message:"unauthenticated"};case 403:return{code:2,message:"permission_denied"};case 404:return{code:2,message:"not_found"};case 409:return{code:2,message:"already_exists"};case 413:return{code:2,message:"failed_precondition"};case 429:return{code:2,message:"resource_exhausted"};case 499:return{code:2,message:"cancelled"};default:return{code:2,message:"invalid_argument"}}if(e>=500&&e<600)switch(e){case 501:return{code:2,message:"unimplemented"};case 503:return{code:2,message:"unavailable"};case 504:return{code:2,message:"deadline_exceeded"};default:return{code:2,message:"internal_error"}}return{code:2,message:"unknown_error"}}function setHttpStatus(e,t){e.setAttribute("http.response.status_code",t);const n=getSpanStatusFromHttpCode(t);"unknown_error"!==n.message&&e.setStatus(n)}const SENTRY_BAGGAGE_KEY_PREFIX="sentry-",SENTRY_BAGGAGE_KEY_PREFIX_REGEX=/^sentry-/,MAX_BAGGAGE_STRING_LENGTH=8192;function baggageHeaderToDynamicSamplingContext(e){const t=parseBaggageHeader(e);if(!t)return;const n=Object.entries(t).reduce(((e,[t,n])=>{if(t.match(SENTRY_BAGGAGE_KEY_PREFIX_REGEX)){e[t.slice(7)]=n}return e}),{});return Object.keys(n).length>0?n:void 0}function dynamicSamplingContextToSentryBaggageHeader(e){if(!e)return;return objectToBaggageHeader(Object.entries(e).reduce(((e,[t,n])=>(n&&(e[`sentry-${t}`]=n),e)),{}))}function parseBaggageHeader(e){if(e&&(isString(e)||Array.isArray(e)))return Array.isArray(e)?e.reduce(((e,t)=>{const n=baggageHeaderToObject(t);return Object.entries(n).forEach((([t,n])=>{e[t]=n})),e}),{}):baggageHeaderToObject(e)}function baggageHeaderToObject(e){return e.split(",").map((e=>e.split("=").map((e=>decodeURIComponent(e.trim()))))).reduce(((e,[t,n])=>(t&&n&&(e[t]=n),e)),{})}function objectToBaggageHeader(e){if(0!==Object.keys(e).length)return Object.entries(e).reduce(((e,[t,n],r)=>{const s=`${encodeURIComponent(t)}=${encodeURIComponent(n)}`,o=0===r?s:`${e},${s}`;return o.length>8192?(DEBUG_BUILD&&logger.warn(`Not adding key: ${t} with val: ${n} to baggage header due to exceeding baggage size limits.`),e):o}),"")}const TRACEPARENT_REGEXP=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function extractTraceparentData(e){if(!e)return;const t=e.match(TRACEPARENT_REGEXP);if(!t)return;let n;return"1"===t[3]?n=!0:"0"===t[3]&&(n=!1),{traceId:t[1],parentSampled:n,parentSpanId:t[2]}}function propagationContextFromHeaders(e,t){const n=extractTraceparentData(e),r=baggageHeaderToDynamicSamplingContext(t);if(!n||!n.traceId)return{traceId:generateTraceId(),spanId:generateSpanId()};const{traceId:s,parentSpanId:o,parentSampled:i}=n;return{traceId:s,parentSpanId:o,spanId:generateSpanId(),sampled:i,dsc:r||{}}}function generateSentryTraceHeader(e=generateTraceId(),t=generateSpanId(),n){let r="";return void 0!==n&&(r=n?"-1":"-0"),`${e}-${t}${r}`}const TRACE_FLAG_NONE=0,TRACE_FLAG_SAMPLED=1;let hasShownSpanDropWarning=!1;function spanToTransactionTraceContext(e){const{spanId:t,traceId:n}=e.spanContext(),{data:r,op:s,parent_span_id:o,status:i,origin:a}=spanToJSON(e);return dropUndefinedKeys({parent_span_id:o,span_id:t,trace_id:n,data:r,op:s,status:i,origin:a})}function spanToTraceContext(e){const{spanId:t,traceId:n,isRemote:r}=e.spanContext();return dropUndefinedKeys({parent_span_id:r?t:spanToJSON(e).parent_span_id,span_id:r?generateSpanId():t,trace_id:n})}function spanToTraceHeader(e){const{traceId:t,spanId:n}=e.spanContext();return generateSentryTraceHeader(t,n,spanIsSampled(e))}function spanTimeInputToSeconds(e){return"number"==typeof e?ensureTimestampInSeconds(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?ensureTimestampInSeconds(e.getTime()):timestampInSeconds()}function ensureTimestampInSeconds(e){return e>9999999999?e/1e3:e}function spanToJSON(e){if(spanIsSentrySpan(e))return e.getSpanJSON();try{const{spanId:t,traceId:n}=e.spanContext();if(spanIsOpenTelemetrySdkTraceBaseSpan(e)){const{attributes:r,startTime:s,name:o,endTime:i,parentSpanId:a,status:c}=e;return dropUndefinedKeys({span_id:t,trace_id:n,data:r,description:o,parent_span_id:a,start_timestamp:spanTimeInputToSeconds(s),timestamp:spanTimeInputToSeconds(i)||void 0,status:getStatusMessage(c),op:r["sentry.op"],origin:r["sentry.origin"],_metrics_summary:getMetricSummaryJsonForSpan(e)})}return{span_id:t,trace_id:n}}catch(e){return{}}}function spanIsOpenTelemetrySdkTraceBaseSpan(e){const t=e;return!!(t.attributes&&t.startTime&&t.name&&t.endTime&&t.status)}function spanIsSentrySpan(e){return"function"==typeof e.getSpanJSON}function spanIsSampled(e){const{traceFlags:t}=e.spanContext();return 1===t}function getStatusMessage(e){if(e&&0!==e.code)return 1===e.code?"ok":e.message||"unknown_error"}const CHILD_SPANS_FIELD="_sentryChildSpans",ROOT_SPAN_FIELD="_sentryRootSpan";function addChildSpanToSpan(e,t){const n=e[ROOT_SPAN_FIELD]||e;addNonEnumerableProperty(t,ROOT_SPAN_FIELD,n),e[CHILD_SPANS_FIELD]?e[CHILD_SPANS_FIELD].add(t):addNonEnumerableProperty(e,CHILD_SPANS_FIELD,new Set([t]))}function getSpanDescendants(e){const t=new Set;return function e(n){if(!t.has(n)&&spanIsSampled(n)){t.add(n);const r=n[CHILD_SPANS_FIELD]?Array.from(n[CHILD_SPANS_FIELD]):[];for(const t of r)e(t)}}(e),Array.from(t)}function getRootSpan(e){return e[ROOT_SPAN_FIELD]||e}function getActiveSpan(){const e=getAsyncContextStrategy(getMainCarrier());return e.getActiveSpan?e.getActiveSpan():_getSpanForScope(getCurrentScope())}function updateMetricSummaryOnActiveSpan(e,t,n,r,s,o){const i=getActiveSpan();i&&updateMetricSummaryOnSpan(i,e,t,n,r,s,o)}function showSpanDropWarning(){hasShownSpanDropWarning||(consoleSandbox((()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")})),hasShownSpanDropWarning=!0)}function updateSpanName(e,t){e.updateName(t),e.setAttributes({[SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"custom",[SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME]:t})}let errorsInstrumented=!1;function registerSpanErrorInstrumentation(){errorsInstrumented||(errorsInstrumented=!0,addGlobalErrorInstrumentationHandler(errorCallback),addGlobalUnhandledRejectionInstrumentationHandler(errorCallback))}function errorCallback(){const e=getActiveSpan(),t=e&&getRootSpan(e);if(t){const e="internal_error";DEBUG_BUILD$1&&logger.log(`[Tracing] Root span: ${e} -> Global error occurred`),t.setStatus({code:2,message:e})}}errorCallback.tag="sentry_tracingErrorCallback";const SCOPE_ON_START_SPAN_FIELD="_sentryScope",ISOLATION_SCOPE_ON_START_SPAN_FIELD="_sentryIsolationScope";function setCapturedScopesOnSpan(e,t,n){e&&(addNonEnumerableProperty(e,"_sentryIsolationScope",n),addNonEnumerableProperty(e,"_sentryScope",t))}function getCapturedScopesOnSpan(e){return{scope:e._sentryScope,isolationScope:e._sentryIsolationScope}}function hasTracingEnabled(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const t=getClient(),n=e||t&&t.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}class SentryNonRecordingSpan{constructor(e={}){this._traceId=e.traceId||generateTraceId(),this._spanId=e.spanId||generateSpanId()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:0}}end(e){}setAttribute(e,t){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,t,n){return this}addLink(e){return this}addLinks(e){return this}recordException(e,t){}}function handleCallbackErrors(e,t,n=()=>{}){let r;try{r=e()}catch(e){throw t(e),n(),e}return maybeHandlePromiseRejection(r,t,n)}function maybeHandlePromiseRejection(e,t,n){return isThenable(e)?e.then((e=>(n(),e)),(e=>{throw t(e),n(),e})):(n(),e)}const DEFAULT_ENVIRONMENT="production",FROZEN_DSC_FIELD="_frozenDsc";function freezeDscOnSpan(e,t){addNonEnumerableProperty(e,"_frozenDsc",t)}function getDynamicSamplingContextFromClient(e,t){const n=t.getOptions(),{publicKey:r}=t.getDsn()||{},s=dropUndefinedKeys({environment:n.environment||DEFAULT_ENVIRONMENT,release:n.release,public_key:r,trace_id:e});return t.emit("createDsc",s),s}function getDynamicSamplingContextFromScope(e,t){const n=t.getPropagationContext();return n.dsc||getDynamicSamplingContextFromClient(n.traceId,e)}function getDynamicSamplingContextFromSpan(e){const t=getClient();if(!t)return{};const n=getRootSpan(e),r=n._frozenDsc;if(r)return r;const s=n.spanContext().traceState,o=s&&s.get("sentry.dsc"),i=o&&baggageHeaderToDynamicSamplingContext(o);if(i)return i;const a=getDynamicSamplingContextFromClient(e.spanContext().traceId,t),c=spanToJSON(n),u=c.data||{},l=u["sentry.sample_rate"];null!=l&&(a.sample_rate=`${l}`);const p=u["sentry.source"],d=c.description;return"url"!==p&&d&&(a.transaction=d),hasTracingEnabled()&&(a.sampled=String(spanIsSampled(n))),t.emit("createDsc",a,n),a}function spanToBaggageHeader(e){return dynamicSamplingContextToSentryBaggageHeader(getDynamicSamplingContextFromSpan(e))}function logSpanStart(e){if(!DEBUG_BUILD$1)return;const{description:t="< unknown name >",op:n="< unknown op >",parent_span_id:r}=spanToJSON(e),{spanId:s}=e.spanContext(),o=spanIsSampled(e),i=getRootSpan(e),a=i===e,c=`[Tracing] Starting ${o?"sampled":"unsampled"} ${a?"root ":""}span`,u=[`op: ${n}`,`name: ${t}`,`ID: ${s}`];if(r&&u.push(`parent ID: ${r}`),!a){const{op:e,description:t}=spanToJSON(i);u.push(`root ID: ${i.spanContext().spanId}`),e&&u.push(`root op: ${e}`),t&&u.push(`root description: ${t}`)}logger.log(`${c}\n  ${u.join("\n  ")}`)}function logSpanEnd(e){if(!DEBUG_BUILD$1)return;const{description:t="< unknown name >",op:n="< unknown op >"}=spanToJSON(e),{spanId:r}=e.spanContext(),s=`[Tracing] Finishing "${n}" ${getRootSpan(e)===e?"root ":""}span "${t}" with ID ${r}`;logger.log(s)}function parseSampleRate(e){if("boolean"==typeof e)return Number(e);const t="string"==typeof e?parseFloat(e):e;if(!("number"!=typeof t||isNaN(t)||t<0||t>1))return t;DEBUG_BUILD$1&&logger.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`)}function sampleSpan(e,t){if(!hasTracingEnabled(e))return[!1];const n=getIsolationScope().getScopeData().sdkProcessingMetadata.normalizedRequest,r={...t,normalizedRequest:t.normalizedRequest||n};let s;s="function"==typeof e.tracesSampler?e.tracesSampler(r):void 0!==r.parentSampled?r.parentSampled:void 0!==e.tracesSampleRate?e.tracesSampleRate:1;const o=parseSampleRate(s);if(void 0===o)return DEBUG_BUILD$1&&logger.warn("[Tracing] Discarding transaction because of invalid sample rate."),[!1];if(!o)return DEBUG_BUILD$1&&logger.log("[Tracing] Discarding transaction because "+("function"==typeof e.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),[!1,o];return Math.random()<o?[!0,o]:(DEBUG_BUILD$1&&logger.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),[!1,o])}const DSN_REGEX=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function isValidProtocol(e){return"http"===e||"https"===e}function dsnToString(e,t=!1){const{host:n,path:r,pass:s,port:o,projectId:i,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&s?`:${s}`:""}@${n}${o?`:${o}`:""}/${r?`${r}/`:r}${i}`}function dsnFromString(e){const t=DSN_REGEX.exec(e);if(!t)return void consoleSandbox((()=>{console.error(`Invalid Sentry Dsn: ${e}`)}));const[n,r,s="",o="",i="",a=""]=t.slice(1);let c="",u=a;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const e=u.match(/^\d+/);e&&(u=e[0])}return dsnFromComponents({host:o,pass:s,path:c,projectId:u,port:i,protocol:n,publicKey:r})}function dsnFromComponents(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function validateDsn(e){if(!DEBUG_BUILD)return!0;const{port:t,projectId:n,protocol:r}=e;return!["protocol","publicKey","host","projectId"].find((t=>!e[t]&&(logger.error(`Invalid Sentry Dsn: ${t} missing`),!0)))&&(n.match(/^\d+$/)?isValidProtocol(r)?!t||!isNaN(parseInt(t,10))||(logger.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):(logger.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(logger.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1))}function makeDsn(e){const t="string"==typeof e?dsnFromString(e):dsnFromComponents(e);if(t&&validateDsn(t))return t}function memoBuilder(){const e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(n){if(e)return!!t.has(n)||(t.add(n),!1);for(let e=0;e<t.length;e++){if(t[e]===n)return!0}return t.push(n),!1},function(n){if(e)t.delete(n);else for(let e=0;e<t.length;e++)if(t[e]===n){t.splice(e,1);break}}]}function normalize(e,t=100,n=1/0){try{return visit("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function normalizeToSize(e,t=3,n=102400){const r=normalize(e,t);return jsonSize(r)>n?normalizeToSize(e,t-1,n):r}function visit(e,t,n=1/0,r=1/0,s=memoBuilder()){const[o,i]=s;if(null==t||["boolean","string"].includes(typeof t)||"number"==typeof t&&Number.isFinite(t))return t;const a=stringifyValue(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:n;if(0===c)return a.replace("object ","");if(o(t))return"[Circular ~]";const u=t;if(u&&"function"==typeof u.toJSON)try{return visit("",u.toJSON(),c-1,r,s)}catch(e){}const l=Array.isArray(t)?[]:{};let p=0;const d=convertToPlainObject(t);for(const e in d){if(!Object.prototype.hasOwnProperty.call(d,e))continue;if(p>=r){l[e]="[MaxProperties ~]";break}const t=d[e];l[e]=visit(e,t,c-1,r,s),p++}return i(t),l}function stringifyValue(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(isVueViewModel(t))return"[VueViewModel]";if(isSyntheticEvent(t))return"[SyntheticEvent]";if("number"==typeof t&&!Number.isFinite(t))return`[${t}]`;if("function"==typeof t)return`[Function: ${getFunctionName(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const n=getConstructorName(t);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(e){return`**non-serializable** (${e})`}}function getConstructorName(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}function utf8Length(e){return~-encodeURI(e).split(/%..|./).length}function jsonSize(e){return utf8Length(JSON.stringify(e))}function createEnvelope(e,t=[]){return[e,t]}function addItemToEnvelope(e,t){const[n,r]=e;return[n,[...r,t]]}function forEachEnvelopeItem(e,t){const n=e[1];for(const e of n){if(t(e,e[0].type))return!0}return!1}function encodeUTF8(e){return GLOBAL_OBJ.__SENTRY__&&GLOBAL_OBJ.__SENTRY__.encodePolyfill?GLOBAL_OBJ.__SENTRY__.encodePolyfill(e):(new TextEncoder).encode(e)}function serializeEnvelope(e){const[t,n]=e;let r=JSON.stringify(t);function s(e){"string"==typeof r?r="string"==typeof e?r+e:[encodeUTF8(r),e]:r.push("string"==typeof e?encodeUTF8(e):e)}for(const e of n){const[t,n]=e;if(s(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)s(n);else{let e;try{e=JSON.stringify(n)}catch(t){e=JSON.stringify(normalize(n))}s(e)}}return"string"==typeof r?r:concatBuffers(r)}function concatBuffers(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}function createSpanEnvelopeItem(e){return[{type:"span"},e]}function createAttachmentEnvelopeItem(e){const t="string"==typeof e.data?encodeUTF8(e.data):e.data;return[dropUndefinedKeys({type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),t]}const ITEM_TYPE_TO_DATA_CATEGORY_MAP={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function envelopeItemTypeToDataCategory(e){return ITEM_TYPE_TO_DATA_CATEGORY_MAP[e]}function getSdkMetadataForEnvelopeHeader(e){if(!e||!e.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function createEventEnvelopeHeaders(e,t,n,r){const s=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:dsnToString(r)},...s&&{trace:dropUndefinedKeys({...s})}}}function enhanceEventWithSdkInfo(e,t){return t?(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]],e):e}function createSessionEnvelope(e,t,n,r){const s=getSdkMetadataForEnvelopeHeader(n);return createEnvelope({sent_at:(new Date).toISOString(),...s&&{sdk:s},...!!r&&t&&{dsn:dsnToString(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}function createEventEnvelope(e,t,n,r){const s=getSdkMetadataForEnvelopeHeader(n),o=e.type&&"replay_event"!==e.type?e.type:"event";enhanceEventWithSdkInfo(e,n&&n.sdk);const i=createEventEnvelopeHeaders(e,s,r,t);delete e.sdkProcessingMetadata;return createEnvelope(i,[[{type:o},e]])}function createSpanEnvelope(e,t){const n=getDynamicSamplingContextFromSpan(e[0]),r=t&&t.getDsn(),s=t&&t.getOptions().tunnel,o={sent_at:(new Date).toISOString(),...function(e){return!!e.trace_id&&!!e.public_key}(n)&&{trace:n},...!!s&&r&&{dsn:dsnToString(r)}},i=t&&t.getOptions().beforeSendSpan,a=i?e=>{const t=i(spanToJSON(e));return t||showSpanDropWarning(),t}:e=>spanToJSON(e),c=[];for(const t of e){const e=a(t);e&&c.push(createSpanEnvelopeItem(e))}return createEnvelope(o,c)}function setMeasurement(e,t,n,r=getActiveSpan()){const s=r&&getRootSpan(r);s&&(DEBUG_BUILD$1&&logger.log(`[Measurement] Setting measurement on root span: ${e} = ${t} ${n}`),s.addEvent(e,{[SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE]:t,[SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT]:n}))}function timedEventsToMeasurements(e){if(!e||0===e.length)return;const t={};return e.forEach((e=>{const n=e.attributes||{},r=n["sentry.measurement_unit"],s=n["sentry.measurement_value"];"string"==typeof r&&"number"==typeof s&&(t[e.name]={value:s,unit:r})})),t}const MAX_SPAN_COUNT=1e3;class SentrySpan{constructor(e={}){this._traceId=e.traceId||generateTraceId(),this._spanId=e.spanId||generateSpanId(),this._startTime=e.startTimestamp||timestampInSeconds(),this._attributes={},this.setAttributes({[SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"manual",[SEMANTIC_ATTRIBUTE_SENTRY_OP]:e.op,...e.attributes}),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this}addLinks(e){return this}recordException(e,t){}spanContext(){const{_spanId:e,_traceId:t,_sampled:n}=this;return{spanId:e,traceId:t,traceFlags:n?1:0}}setAttribute(e,t){return void 0===t?delete this._attributes[e]:this._attributes[e]=t,this}setAttributes(e){return Object.keys(e).forEach((t=>this.setAttribute(t,e[t]))),this}updateStartTime(e){this._startTime=spanTimeInputToSeconds(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute("sentry.source","custom"),this}end(e){this._endTime||(this._endTime=spanTimeInputToSeconds(e),logSpanEnd(this),this._onSpanEnded())}getSpanJSON(){return dropUndefinedKeys({data:this._attributes,description:this._name,op:this._attributes["sentry.op"],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:getStatusMessage(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes["sentry.origin"],_metrics_summary:getMetricSummaryJsonForSpan(this),profile_id:this._attributes["sentry.profile_id"],exclusive_time:this._attributes["sentry.exclusive_time"],measurements:timedEventsToMeasurements(this._events),is_segment:this._isStandaloneSpan&&getRootSpan(this)===this||void 0,segment_id:this._isStandaloneSpan?getRootSpan(this).spanContext().spanId:void 0})}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,t,n){DEBUG_BUILD$1&&logger.log("[Tracing] Adding an event to span:",e);const r=isSpanTimeInput(t)?t:n||timestampInSeconds(),s=isSpanTimeInput(t)?{}:t||{},o={name:e,time:spanTimeInputToSeconds(r),attributes:s};return this._events.push(o),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=getClient();e&&e.emit("spanEnd",this);if(!(this._isStandaloneSpan||this===getRootSpan(this)))return;if(this._isStandaloneSpan)return void(this._sampled?sendSpanEnvelope(createSpanEnvelope([this],e)):(DEBUG_BUILD$1&&logger.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span")));const t=this._convertSpanToTransaction();if(t){(getCapturedScopesOnSpan(this).scope||getCurrentScope()).captureEvent(t)}}_convertSpanToTransaction(){if(!isFullFinishedSpan(spanToJSON(this)))return;this._name||(DEBUG_BUILD$1&&logger.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:t}=getCapturedScopesOnSpan(this),n=(e||getCurrentScope()).getClient()||getClient();if(!0!==this._sampled)return DEBUG_BUILD$1&&logger.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),void(n&&n.recordDroppedEvent("sample_rate","transaction"));const r=getSpanDescendants(this).filter((e=>e!==this&&!isStandaloneSpan(e))).map((e=>spanToJSON(e))).filter(isFullFinishedSpan),s=this._attributes["sentry.source"];delete this._attributes["sentry.custom_span_name"],r.forEach((e=>{e.data&&delete e.data["sentry.custom_span_name"]}));const o={contexts:{trace:spanToTransactionTraceContext(this)},spans:r.length>1e3?r.sort(((e,t)=>e.start_timestamp-t.start_timestamp)).slice(0,1e3):r,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:t,...dropUndefinedKeys({dynamicSamplingContext:getDynamicSamplingContextFromSpan(this)})},_metrics_summary:getMetricSummaryJsonForSpan(this),...s&&{transaction_info:{source:s}}},i=timedEventsToMeasurements(this._events);return i&&Object.keys(i).length&&(DEBUG_BUILD$1&&logger.log("[Measurements] Adding measurements to transaction event",JSON.stringify(i,void 0,2)),o.measurements=i),o}}function isSpanTimeInput(e){return e&&"number"==typeof e||e instanceof Date||Array.isArray(e)}function isFullFinishedSpan(e){return!!(e.start_timestamp&&e.timestamp&&e.span_id&&e.trace_id)}function isStandaloneSpan(e){return e instanceof SentrySpan&&e.isStandaloneSpan()}function sendSpanEnvelope(e){const t=getClient();if(!t)return;const n=e[1];n&&0!==n.length?t.sendEnvelope(e):t.recordDroppedEvent("before_send","span")}const SUPPRESS_TRACING_KEY="__SENTRY_SUPPRESS_TRACING__";function startSpan(e,t){const n=getAcs();if(n.startSpan)return n.startSpan(e,t);const r=parseSentrySpanArguments(e),{forceTransaction:s,parentSpan:o}=e;return withScope(e.scope,(()=>getActiveSpanWrapper(o)((()=>{const n=getCurrentScope(),o=getParentSpan(n),i=e.onlyIfParent&&!o?new SentryNonRecordingSpan:createChildOrRootSpan({parentSpan:o,spanArguments:r,forceTransaction:s,scope:n});return _setSpanForScope(n,i),handleCallbackErrors((()=>t(i)),(()=>{const{status:e}=spanToJSON(i);!i.isRecording()||e&&"ok"!==e||i.setStatus({code:2,message:"internal_error"})}),(()=>i.end()))}))))}function startSpanManual(e,t){const n=getAcs();if(n.startSpanManual)return n.startSpanManual(e,t);const r=parseSentrySpanArguments(e),{forceTransaction:s,parentSpan:o}=e;return withScope(e.scope,(()=>getActiveSpanWrapper(o)((()=>{const n=getCurrentScope(),o=getParentSpan(n),i=e.onlyIfParent&&!o?new SentryNonRecordingSpan:createChildOrRootSpan({parentSpan:o,spanArguments:r,forceTransaction:s,scope:n});function a(){i.end()}return _setSpanForScope(n,i),handleCallbackErrors((()=>t(i,a)),(()=>{const{status:e}=spanToJSON(i);!i.isRecording()||e&&"ok"!==e||i.setStatus({code:2,message:"internal_error"})}))}))))}function startInactiveSpan(e){const t=getAcs();if(t.startInactiveSpan)return t.startInactiveSpan(e);const n=parseSentrySpanArguments(e),{forceTransaction:r,parentSpan:s}=e;return(e.scope?t=>withScope(e.scope,t):void 0!==s?e=>withActiveSpan(s,e):e=>e())((()=>{const t=getCurrentScope(),s=getParentSpan(t);return e.onlyIfParent&&!s?new SentryNonRecordingSpan:createChildOrRootSpan({parentSpan:s,spanArguments:n,forceTransaction:r,scope:t})}))}const continueTrace=(e,t)=>{const n=getAsyncContextStrategy(getMainCarrier());if(n.continueTrace)return n.continueTrace(e,t);const{sentryTrace:r,baggage:s}=e;return withScope((e=>{const n=propagationContextFromHeaders(r,s);return e.setPropagationContext(n),t()}))};function withActiveSpan(e,t){const n=getAcs();return n.withActiveSpan?n.withActiveSpan(e,t):withScope((n=>(_setSpanForScope(n,e||void 0),t(n))))}function suppressTracing(e){const t=getAcs();return t.suppressTracing?t.suppressTracing(e):withScope((t=>(t.setSDKProcessingMetadata({[SUPPRESS_TRACING_KEY]:!0}),e())))}function startNewTrace(e){return withScope((t=>(t.setPropagationContext({traceId:generateTraceId()}),DEBUG_BUILD$1&&logger.info(`Starting a new trace with id ${t.getPropagationContext().traceId}`),withActiveSpan(null,e))))}function createChildOrRootSpan({parentSpan:e,spanArguments:t,forceTransaction:n,scope:r}){if(!hasTracingEnabled())return new SentryNonRecordingSpan;const s=getIsolationScope();let o;if(e&&!n)o=_startChildSpan(e,r,t),addChildSpanToSpan(e,o);else if(e){const n=getDynamicSamplingContextFromSpan(e),{traceId:s,spanId:i}=e.spanContext(),a=spanIsSampled(e);o=_startRootSpan({traceId:s,parentSpanId:i,...t},r,a),freezeDscOnSpan(o,n)}else{const{traceId:e,dsc:n,parentSpanId:i,sampled:a}={...s.getPropagationContext(),...r.getPropagationContext()};o=_startRootSpan({traceId:e,parentSpanId:i,...t},r,a),n&&freezeDscOnSpan(o,n)}return logSpanStart(o),setCapturedScopesOnSpan(o,r,s),o}function parseSentrySpanArguments(e){const t={isStandalone:(e.experimental||{}).standalone,...e};if(e.startTime){const n={...t};return n.startTimestamp=spanTimeInputToSeconds(e.startTime),delete n.startTime,n}return t}function getAcs(){return getAsyncContextStrategy(getMainCarrier())}function _startRootSpan(e,t,n){const r=getClient(),s=r&&r.getOptions()||{},{name:o="",attributes:i}=e,[a,c]=t.getScopeData().sdkProcessingMetadata[SUPPRESS_TRACING_KEY]?[!1]:sampleSpan(s,{name:o,parentSampled:n,attributes:i,transactionContext:{name:o,parentSampled:n}}),u=new SentrySpan({...e,attributes:{[SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"custom",...e.attributes},sampled:a});return void 0!==c&&u.setAttribute("sentry.sample_rate",c),r&&r.emit("spanStart",u),u}function _startChildSpan(e,t,n){const{spanId:r,traceId:s}=e.spanContext(),o=!t.getScopeData().sdkProcessingMetadata[SUPPRESS_TRACING_KEY]&&spanIsSampled(e),i=o?new SentrySpan({...n,parentSpanId:r,traceId:s,sampled:o}):new SentryNonRecordingSpan({traceId:s});addChildSpanToSpan(e,i);const a=getClient();return a&&(a.emit("spanStart",i),n.endTimestamp&&a.emit("spanEnd",i)),i}function getParentSpan(e){const t=_getSpanForScope(e);if(!t)return;const n=getClient();return(n?n.getOptions():{}).parentSpanIsAlwaysRootSpan?getRootSpan(t):t}function getActiveSpanWrapper(e){return void 0!==e?t=>withActiveSpan(e,t):e=>e()}function notifyEventProcessors(e,t,n,r=0){return new SyncPromise(((s,o)=>{const i=e[r];if(null===t||"function"!=typeof i)s(t);else{const a=i({...t},n);DEBUG_BUILD$1&&i.id&&null===a&&logger.log(`Event processor "${i.id}" dropped event`),isThenable(a)?a.then((t=>notifyEventProcessors(e,t,n,r+1).then(s))).then(null,o):notifyEventProcessors(e,a,n,r+1).then(s).then(null,o)}}))}let parsedStackResults,lastKeysCount,cachedFilenameDebugIds;function getFilenameToDebugIdMap(e){const t=GLOBAL_OBJ._sentryDebugIds;if(!t)return{};const n=Object.keys(t);return cachedFilenameDebugIds&&n.length===lastKeysCount||(lastKeysCount=n.length,cachedFilenameDebugIds=n.reduce(((n,r)=>{parsedStackResults||(parsedStackResults={});const s=parsedStackResults[r];if(s)n[s[0]]=s[1];else{const s=e(r);for(let e=s.length-1;e>=0;e--){const o=s[e],i=o&&o.filename,a=t[r];if(i&&a){n[i]=a,parsedStackResults[r]=[i,a];break}}}return n}),{})),cachedFilenameDebugIds}function applyScopeDataToEvent(e,t){const{fingerprint:n,span:r,breadcrumbs:s,sdkProcessingMetadata:o}=t;applyDataToEvent(e,t),r&&applySpanToEvent(e,r),applyFingerprintToEvent(e,n),applyBreadcrumbsToEvent(e,s),applySdkMetadataToEvent(e,o)}function mergeScopeData(e,t){const{extra:n,tags:r,user:s,contexts:o,level:i,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:u,eventProcessors:l,attachments:p,propagationContext:d,transactionName:g,span:m}=t;mergeAndOverwriteScopeData(e,"extra",n),mergeAndOverwriteScopeData(e,"tags",r),mergeAndOverwriteScopeData(e,"user",s),mergeAndOverwriteScopeData(e,"contexts",o),e.sdkProcessingMetadata=merge(e.sdkProcessingMetadata,a,2),i&&(e.level=i),g&&(e.transactionName=g),m&&(e.span=m),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),u.length&&(e.fingerprint=[...e.fingerprint,...u]),l.length&&(e.eventProcessors=[...e.eventProcessors,...l]),p.length&&(e.attachments=[...e.attachments,...p]),e.propagationContext={...e.propagationContext,...d}}function mergeAndOverwriteScopeData(e,t,n){e[t]=merge(e[t],n,1)}function applyDataToEvent(e,t){const{extra:n,tags:r,user:s,contexts:o,level:i,transactionName:a}=t,c=dropUndefinedKeys(n);c&&Object.keys(c).length&&(e.extra={...c,...e.extra});const u=dropUndefinedKeys(r);u&&Object.keys(u).length&&(e.tags={...u,...e.tags});const l=dropUndefinedKeys(s);l&&Object.keys(l).length&&(e.user={...l,...e.user});const p=dropUndefinedKeys(o);p&&Object.keys(p).length&&(e.contexts={...p,...e.contexts}),i&&(e.level=i),a&&"transaction"!==e.type&&(e.transaction=a)}function applyBreadcrumbsToEvent(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}function applySdkMetadataToEvent(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}function applySpanToEvent(e,t){e.contexts={trace:spanToTraceContext(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:getDynamicSamplingContextFromSpan(t),...e.sdkProcessingMetadata};const n=spanToJSON(getRootSpan(t)).description;n&&!e.transaction&&"transaction"===e.type&&(e.transaction=n)}function applyFingerprintToEvent(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}function prepareEvent(e,t,n,r,s,o){const{normalizeDepth:i=3,normalizeMaxBreadth:a=1e3}=e,c={...t,event_id:t.event_id||n.event_id||uuid4(),timestamp:t.timestamp||dateTimestampInSeconds()},u=n.integrations||e.integrations.map((e=>e.name));applyClientOptions(c,e),applyIntegrationsMetadata(c,u),s&&s.emit("applyFrameMetadata",t),void 0===t.type&&applyDebugIds(c,e.stackParser);const l=getFinalScope(r,n.captureContext);n.mechanism&&addExceptionMechanism(c,n.mechanism);const p=s?s.getEventProcessors():[],d=getGlobalScope().getScopeData();if(o){mergeScopeData(d,o.getScopeData())}if(l){mergeScopeData(d,l.getScopeData())}const g=[...n.attachments||[],...d.attachments];g.length&&(n.attachments=g),applyScopeDataToEvent(c,d);return notifyEventProcessors([...p,...d.eventProcessors],c,n).then((e=>(e&&applyDebugMeta(e),"number"==typeof i&&i>0?normalizeEvent(e,i,a):e)))}function applyClientOptions(e,t){const{environment:n,release:r,dist:s,maxValueLength:o=250}=t;e.environment=e.environment||n||DEFAULT_ENVIRONMENT,!e.release&&r&&(e.release=r),!e.dist&&s&&(e.dist=s),e.message&&(e.message=truncate(e.message,o));const i=e.exception&&e.exception.values&&e.exception.values[0];i&&i.value&&(i.value=truncate(i.value,o));const a=e.request;a&&a.url&&(a.url=truncate(a.url,o))}function applyDebugIds(e,t){const n=getFilenameToDebugIdMap(t);try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{n&&e.filename&&(e.debug_id=n[e.filename])}))}))}catch(e){}}function applyDebugMeta(e){const t={};try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)}))}))}catch(e){}if(0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.entries(t).forEach((([e,t])=>{n.push({type:"sourcemap",code_file:e,debug_id:t})}))}function applyIntegrationsMetadata(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}function normalizeEvent(e,t,n){if(!e)return null;const r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((e=>({...e,...e.data&&{data:normalize(e.data,t,n)}})))},...e.user&&{user:normalize(e.user,t,n)},...e.contexts&&{contexts:normalize(e.contexts,t,n)},...e.extra&&{extra:normalize(e.extra,t,n)}};return e.contexts&&e.contexts.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=normalize(e.contexts.trace.data,t,n))),e.spans&&(r.spans=e.spans.map((e=>({...e,...e.data&&{data:normalize(e.data,t,n)}})))),e.contexts&&e.contexts.flags&&r.contexts&&(r.contexts.flags=normalize(e.contexts.flags,3,n)),r}function getFinalScope(e,t){if(!t)return e;const n=e?e.clone():new Scope;return n.update(t),n}function parseEventHintOrCaptureContext(e){if(e)return hintIsScopeOrFunction(e)||hintIsScopeContext(e)?{captureContext:e}:e}function hintIsScopeOrFunction(e){return e instanceof Scope||"function"==typeof e}const captureContextKeys=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function hintIsScopeContext(e){return Object.keys(e).some((e=>captureContextKeys.includes(e)))}function captureException(e,t){return getCurrentScope().captureException(e,parseEventHintOrCaptureContext(t))}function captureMessage(e,t){const n="string"==typeof t?t:void 0,r="string"!=typeof t?{captureContext:t}:void 0;return getCurrentScope().captureMessage(e,n,r)}function captureEvent(e,t){return getCurrentScope().captureEvent(e,t)}function setContext(e,t){getIsolationScope().setContext(e,t)}function setExtras(e){getIsolationScope().setExtras(e)}function setExtra(e,t){getIsolationScope().setExtra(e,t)}function setTags(e){getIsolationScope().setTags(e)}function setTag(e,t){getIsolationScope().setTag(e,t)}function setUser(e){getIsolationScope().setUser(e)}function lastEventId(){return getIsolationScope().lastEventId()}function captureCheckIn(e,t){const n=getCurrentScope(),r=getClient();if(r){if(r.captureCheckIn)return r.captureCheckIn(e,t,n);DEBUG_BUILD$1&&logger.warn("Cannot capture check-in. Client does not support sending check-ins.")}else DEBUG_BUILD$1&&logger.warn("Cannot capture check-in. No client defined.");return uuid4()}function withMonitor(e,t,n){const r=captureCheckIn({monitorSlug:e,status:"in_progress"},n),s=timestampInSeconds();function o(t){captureCheckIn({monitorSlug:e,status:t,checkInId:r,duration:timestampInSeconds()-s})}return withIsolationScope((()=>{let e;try{e=t()}catch(e){throw o("error"),e}return isThenable(e)?Promise.resolve(e).then((()=>{o("ok")}),(e=>{throw o("error"),e})):o("ok"),e}))}async function flush(e){const t=getClient();return t?t.flush(e):(DEBUG_BUILD$1&&logger.warn("Cannot flush events. No client defined."),Promise.resolve(!1))}async function close(e){const t=getClient();return t?t.close(e):(DEBUG_BUILD$1&&logger.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))}function isInitialized(){return!!getClient()}function isEnabled(){const e=getClient();return!!e&&!1!==e.getOptions().enabled&&!!e.getTransport()}function addEventProcessor(e){getIsolationScope().addEventProcessor(e)}function startSession(e){const t=getClient(),n=getIsolationScope(),r=getCurrentScope(),{release:s,environment:o=DEFAULT_ENVIRONMENT}=t&&t.getOptions()||{},{userAgent:i}=GLOBAL_OBJ.navigator||{},a=makeSession({release:s,environment:o,user:r.getUser()||n.getUser(),...i&&{userAgent:i},...e}),c=n.getSession();return c&&"ok"===c.status&&updateSession(c,{status:"exited"}),endSession(),n.setSession(a),r.setSession(a),a}function endSession(){const e=getIsolationScope(),t=getCurrentScope(),n=t.getSession()||e.getSession();n&&closeSession(n),_sendSessionUpdate(),e.setSession(),t.setSession()}function _sendSessionUpdate(){const e=getIsolationScope(),t=getCurrentScope(),n=getClient(),r=t.getSession()||e.getSession();r&&n&&n.captureSession(r)}function captureSession(e=!1){e?endSession():_sendSessionUpdate()}class SessionFlusher{constructor(e,t){this._client=e,this.flushTimeout=60,this._pendingAggregates=new Map,this._isEnabled=!0,this._intervalId=setInterval((()=>this.flush()),1e3*this.flushTimeout),this._intervalId.unref&&this._intervalId.unref(),this._sessionAttrs=t}flush(){const e=this.getSessionAggregates();0!==e.aggregates.length&&(this._pendingAggregates=new Map,this._client.sendSession(e))}getSessionAggregates(){const e=Array.from(this._pendingAggregates.values());return dropUndefinedKeys({attrs:this._sessionAttrs,aggregates:e})}close(){clearInterval(this._intervalId),this._isEnabled=!1,this.flush()}incrementSessionStatusCount(){if(!this._isEnabled)return;const e=getIsolationScope(),t=e.getRequestSession();t&&t.status&&(this._incrementSessionStatusCount(t.status,new Date),e.setRequestSession(void 0))}_incrementSessionStatusCount(e,t){const n=new Date(t).setSeconds(0,0);let r=this._pendingAggregates.get(n);switch(r||(r={started:new Date(n).toISOString()},this._pendingAggregates.set(n,r)),e){case"errored":return r.errored=(r.errored||0)+1,r.errored;case"ok":return r.exited=(r.exited||0)+1,r.exited;default:return r.crashed=(r.crashed||0)+1,r.crashed}}}const SENTRY_API_VERSION="7";function getBaseApiEndpoint(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function _getIngestEndpoint(e){return`${getBaseApiEndpoint(e)}${e.projectId}/envelope/`}function _encodedAuth(e,t){const n={sentry_version:"7"};return e.publicKey&&(n.sentry_key=e.publicKey),t&&(n.sentry_client=`${t.name}/${t.version}`),new URLSearchParams(n).toString()}function getEnvelopeEndpointWithUrlEncodedAuth(e,t,n){return t||`${_getIngestEndpoint(e)}?${_encodedAuth(e,n)}`}const installedIntegrations=[];function filterDuplicates(e){const t={};return e.forEach((e=>{const{name:n}=e,r=t[n];r&&!r.isDefaultInstance&&e.isDefaultInstance||(t[n]=e)})),Object.values(t)}function getIntegrationsToSetup(e){const t=e.defaultIntegrations||[],n=e.integrations;let r;if(t.forEach((e=>{e.isDefaultInstance=!0})),Array.isArray(n))r=[...t,...n];else if("function"==typeof n){const e=n(t);r=Array.isArray(e)?e:[e]}else r=t;const s=filterDuplicates(r),o=s.findIndex((e=>"Debug"===e.name));if(o>-1){const[e]=s.splice(o,1);s.push(e)}return s}function setupIntegrations(e,t){const n={};return t.forEach((t=>{t&&setupIntegration(e,t,n)})),n}function afterSetupIntegrations(e,t){for(const n of t)n&&n.afterAllSetup&&n.afterAllSetup(e)}function setupIntegration(e,t,n){if(n[t.name])DEBUG_BUILD$1&&logger.log(`Integration skipped because it was already installed: ${t.name}`);else{if(n[t.name]=t,-1===installedIntegrations.indexOf(t.name)&&"function"==typeof t.setupOnce&&(t.setupOnce(),installedIntegrations.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),"function"==typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",((t,r)=>n(t,r,e)))}if("function"==typeof t.processEvent){const n=t.processEvent.bind(t),r=Object.assign(((t,r)=>n(t,r,e)),{id:t.name});e.addEventProcessor(r)}DEBUG_BUILD$1&&logger.log(`Integration installed: ${t.name}`)}}function defineIntegration(e){return e}function createClientReportEnvelope(e,t,n){return createEnvelope(t?{dsn:t}:{},[[{type:"client_report"},{timestamp:dateTimestampInSeconds(),discarded_events:e}]])}class SentryError extends Error{constructor(e,t="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=t}}const ALREADY_SEEN_ERROR="Not capturing exception because it's already been captured.";class BaseClient{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=makeDsn(e.dsn):DEBUG_BUILD$1&&logger.warn("No DSN provided, client will not send events."),this._dsn){const t=getEnvelopeEndpointWithUrlEncodedAuth(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}const t=["enableTracing","tracesSampleRate","tracesSampler"].find((t=>t in e&&null==e[t]));t&&consoleSandbox((()=>{console.warn(`[Sentry] Deprecation warning: \`${t}\` is set to undefined, which leads to tracing being enabled. In v9, a value of \`undefined\` will result in tracing being disabled.`)}))}captureException(e,t,n){const r=uuid4();if(checkOrSetAlreadyCaught(e))return DEBUG_BUILD$1&&logger.log(ALREADY_SEEN_ERROR),r;const s={event_id:r,...t};return this._process(this.eventFromException(e,s).then((e=>this._captureEvent(e,s,n)))),s.event_id}captureMessage(e,t,n,r){const s={event_id:uuid4(),...n},o=isParameterizedString(e)?e:String(e),i=isPrimitive(e)?this.eventFromMessage(o,t,s):this.eventFromException(e,s);return this._process(i.then((e=>this._captureEvent(e,s,r)))),s.event_id}captureEvent(e,t,n){const r=uuid4();if(t&&t.originalException&&checkOrSetAlreadyCaught(t.originalException))return DEBUG_BUILD$1&&logger.log(ALREADY_SEEN_ERROR),r;const s={event_id:r,...t},o=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,s,o||n)),s.event_id}captureSession(e){"string"!=typeof e.release?DEBUG_BUILD$1&&logger.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),updateSession(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then((n=>t.flush(e).then((e=>n&&e))))):resolvedSyncPromise(!0)}close(e){return this.flush(e).then((e=>(this.getOptions().enabled=!1,this.emit("close"),e)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some((({name:e})=>e.startsWith("Spotlight"))))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];setupIntegration(this,e,this._integrations),t||afterSetupIntegrations(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=createEventEnvelope(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=addItemToEnvelope(n,createAttachmentEnvelopeItem(e));const r=this.sendEnvelope(n);r&&r.then((t=>this.emit("afterSendEvent",e,t)),null)}sendSession(e){const t=createSessionEnvelope(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(t)}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){const r="number"==typeof n?n:1,s=`${e}:${t}`;DEBUG_BUILD$1&&logger.log(`Recording outcome: "${s}"${r>1?` (${r} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+r}}on(e,t){const n=this._hooks[e]=this._hooks[e]||[];return n.push(t),()=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)}}emit(e,...t){const n=this._hooks[e];n&&n.forEach((e=>e(...t)))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,(e=>(DEBUG_BUILD$1&&logger.error("Error while sending envelope:",e),e))):(DEBUG_BUILD$1&&logger.error("Transport disabled"),resolvedSyncPromise({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=setupIntegrations(this,e),afterSetupIntegrations(this,e)}_updateSessionFromEvent(e,t){let n=!1,r=!1;const s=t.exception&&t.exception.values;if(s){r=!0;for(const e of s){const t=e.mechanism;if(t&&!1===t.handled){n=!0;break}}}const o="ok"===e.status;(o&&0===e.errors||o&&n)&&(updateSession(e,{...n&&{status:"crashed"},errors:e.errors||Number(r||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new SyncPromise((t=>{let n=0;const r=setInterval((()=>{0==this._numProcessing?(clearInterval(r),t(!0)):(n+=1,e&&n>=e&&(clearInterval(r),t(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n=getCurrentScope(),r=getIsolationScope()){const s=this.getOptions(),o=Object.keys(this._integrations);return!t.integrations&&o.length>0&&(t.integrations=o),this.emit("preprocessEvent",e,t),e.type||r.setLastEventId(e.event_id||t.event_id),prepareEvent(s,e,t,n,this,r).then((e=>{if(null===e)return e;e.contexts={trace:getTraceContextFromScope(n),...e.contexts};const t=getDynamicSamplingContextFromScope(this,n);return e.sdkProcessingMetadata={dynamicSamplingContext:t,...e.sdkProcessingMetadata},e}))}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then((e=>e.event_id),(e=>{if(DEBUG_BUILD$1){const t=e;"log"===t.logLevel?logger.log(t.message):logger.warn(t)}}))}_processEvent(e,t,n){const r=this.getOptions(),{sampleRate:s}=r,o=isTransactionEvent(e),i=isErrorEvent(e),a=e.type||"error",c=`before send for type \`${a}\``,u=void 0===s?void 0:parseSampleRate(s);if(i&&"number"==typeof u&&Math.random()>u)return this.recordDroppedEvent("sample_rate","error",e),rejectedSyncPromise(new SentryError(`Discarding event because it's not included in the random sample (sampling rate = ${s})`,"log"));const l="replay_event"===a?"replay":a,p=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,n,p).then((n=>{if(null===n)throw this.recordDroppedEvent("event_processor",l,e),new SentryError("An event processor returned `null`, will not send event.","log");if(t.data&&!0===t.data.__sentry__)return n;return _validateBeforeSendResult(processBeforeSend(this,r,n,t),c)})).then((r=>{if(null===r){if(this.recordDroppedEvent("before_send",l,e),o){const t=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",t)}throw new SentryError(`${c} returned \`null\`, will not send event.`,"log")}const s=n&&n.getSession();if(!o&&s&&this._updateSessionFromEvent(s,r),o){const e=(r.sdkProcessingMetadata&&r.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(r.spans?r.spans.length:0);e>0&&this.recordDroppedEvent("before_send","span",e)}const i=r.transaction_info;if(o&&i&&r.transaction!==e.transaction){const e="custom";r.transaction_info={...i,source:e}}return this.sendEvent(r,t),r})).then(null,(e=>{if(e instanceof SentryError)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new SentryError(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}_process(e){this._numProcessing++,e.then((e=>(this._numProcessing--,e)),(e=>(this._numProcessing--,e)))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map((([e,t])=>{const[n,r]=e.split(":");return{reason:n,category:r,quantity:t}}))}_flushOutcomes(){DEBUG_BUILD$1&&logger.log("Flushing outcomes...");const e=this._clearOutcomes();if(0===e.length)return void(DEBUG_BUILD$1&&logger.log("No outcomes to send"));if(!this._dsn)return void(DEBUG_BUILD$1&&logger.log("No dsn provided, will not send outcomes"));DEBUG_BUILD$1&&logger.log("Sending outcomes:",e);const t=createClientReportEnvelope(e,this._options.tunnel&&dsnToString(this._dsn));this.sendEnvelope(t)}}function _validateBeforeSendResult(e,t){const n=`${t} must return \`null\` or a valid event.`;if(isThenable(e))return e.then((e=>{if(!isPlainObject(e)&&null!==e)throw new SentryError(n);return e}),(e=>{throw new SentryError(`${t} rejected with ${e}`)}));if(!isPlainObject(e)&&null!==e)throw new SentryError(n);return e}function processBeforeSend(e,t,n,r){const{beforeSend:s,beforeSendTransaction:o,beforeSendSpan:i}=t;if(isErrorEvent(n)&&s)return s(n,r);if(isTransactionEvent(n)){if(n.spans&&i){const t=[];for(const r of n.spans){const n=i(r);n?t.push(n):(showSpanDropWarning(),e.recordDroppedEvent("before_send","span"))}n.spans=t}if(o){if(n.spans){const e=n.spans.length;n.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:e}}return o(n,r)}}return n}function isErrorEvent(e){return void 0===e.type}function isTransactionEvent(e){return"transaction"===e.type}function createCheckInEnvelope(e,t,n,r,s){const o={sent_at:(new Date).toISOString()};n&&n.sdk&&(o.sdk={name:n.sdk.name,version:n.sdk.version}),r&&s&&(o.dsn=dsnToString(s)),t&&(o.trace=dropUndefinedKeys(t));return createEnvelope(o,[createCheckInEnvelopeItem(e)])}function createCheckInEnvelopeItem(e){return[{type:"check_in"},e]}function parseStackFrames(e,t){return e(t.stack||"",1)}function exceptionFromError(e,t){const n={type:t.name||t.constructor.name,value:t.message},r=parseStackFrames(e,t);return r.length&&(n.stacktrace={frames:r}),n}function getErrorPropertyFromObject(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}}function getMessageForObject(e){if("name"in e&&"string"==typeof e.name){let t=`'${e.name}' captured as exception`;return"message"in e&&"string"==typeof e.message&&(t+=` with message '${e.message}'`),t}if("message"in e&&"string"==typeof e.message)return e.message;const t=extractExceptionKeysForMessage(e);if(isErrorEvent$1(e))return`Event \`ErrorEvent\` captured as exception with message \`${e.message}\``;const n=getObjectClassName(e);return`${n&&"Object"!==n?`'${n}'`:"Object"} captured as exception with keys: ${t}`}function getObjectClassName(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch(e){}}function getException(e,t,n,r){if(isError(n))return[n,void 0];if(t.synthetic=!0,isPlainObject(n)){const t={__serialized__:normalizeToSize(n,e&&e.getOptions().normalizeDepth)},s=getErrorPropertyFromObject(n);if(s)return[s,t];const o=getMessageForObject(n),i=r&&r.syntheticException||new Error(o);return i.message=o,[i,t]}const s=r&&r.syntheticException||new Error(n);return s.message=`${n}`,[s,void 0]}function eventFromUnknownInput(e,t,n,r){const s=r&&r.data&&r.data.mechanism||{handled:!0,type:"generic"},[o,i]=getException(e,s,n,r),a={exception:{values:[exceptionFromError(t,o)]}};return i&&(a.extra=i),addExceptionTypeValue(a),addExceptionMechanism(a,s),{...a,event_id:r&&r.event_id}}function eventFromMessage(e,t,n="info",r,s){const o={event_id:r&&r.event_id,level:n};if(s&&r&&r.syntheticException){const n=parseStackFrames(e,r.syntheticException);n.length&&(o.exception={values:[{value:t,stacktrace:{frames:n}}]},addExceptionMechanism(o,{synthetic:!0}))}if(isParameterizedString(t)){const{__sentry_template_string__:e,__sentry_template_values__:n}=t;return o.logentry={message:e,params:n},o}return o.message=t,o}class ServerRuntimeClient extends BaseClient{constructor(e){registerSpanErrorInstrumentation(),super(e)}eventFromException(e,t){const n=eventFromUnknownInput(this,this._options.stackParser,e,t);return n.level="error",resolvedSyncPromise(n)}eventFromMessage(e,t="info",n){return resolvedSyncPromise(eventFromMessage(this._options.stackParser,e,t,n,this._options.attachStacktrace))}captureException(e,t,n){if(this._options.autoSessionTracking&&this._sessionFlusher){const e=getIsolationScope().getRequestSession();e&&"ok"===e.status&&(e.status="errored")}return super.captureException(e,t,n)}captureEvent(e,t,n){if(this._options.autoSessionTracking&&this._sessionFlusher){if("exception"===(e.type||"exception")&&e.exception&&e.exception.values&&e.exception.values.length>0){const e=getIsolationScope().getRequestSession();e&&"ok"===e.status&&(e.status="errored")}}return super.captureEvent(e,t,n)}close(e){return this._sessionFlusher&&this._sessionFlusher.close(),super.close(e)}initSessionFlusher(){const{release:e,environment:t}=this._options;e?this._sessionFlusher=new SessionFlusher(this,{release:e,environment:t}):DEBUG_BUILD$1&&logger.warn("Cannot initialize an instance of SessionFlusher if no release is provided!")}captureCheckIn(e,t,n){const r="checkInId"in e&&e.checkInId?e.checkInId:uuid4();if(!this._isEnabled())return DEBUG_BUILD$1&&logger.warn("SDK not enabled, will not capture checkin."),r;const s=this.getOptions(),{release:o,environment:i,tunnel:a}=s,c={check_in_id:r,monitor_slug:e.monitorSlug,status:e.status,release:o,environment:i};"duration"in e&&(c.duration=e.duration),t&&(c.monitor_config={schedule:t.schedule,checkin_margin:t.checkinMargin,max_runtime:t.maxRuntime,timezone:t.timezone,failure_issue_threshold:t.failureIssueThreshold,recovery_threshold:t.recoveryThreshold});const[u,l]=this._getTraceInfoFromScope(n);l&&(c.contexts={trace:l});const p=createCheckInEnvelope(c,u,this.getSdkMetadata(),a,this.getDsn());return DEBUG_BUILD$1&&logger.info("Sending checkin:",e.monitorSlug,e.status),this.sendEnvelope(p),r}_captureRequestSession(){this._sessionFlusher?this._sessionFlusher.incrementSessionStatusCount():DEBUG_BUILD$1&&logger.warn("Discarded request mode session because autoSessionTracking option was disabled")}_prepareEvent(e,t,n,r){return this._options.platform&&(e.platform=e.platform||this._options.platform),this._options.runtime&&(e.contexts={...e.contexts,runtime:(e.contexts||{}).runtime||this._options.runtime}),this._options.serverName&&(e.server_name=e.server_name||this._options.serverName),super._prepareEvent(e,t,n,r)}_getTraceInfoFromScope(e){if(!e)return[void 0,void 0];const t=_getSpanForScope(e),n=t?spanToTraceContext(t):getTraceContextFromScope(e);return[t?getDynamicSamplingContextFromSpan(t):getDynamicSamplingContextFromScope(this,e),n]}}function initAndBind(e,t){!0===t.debug&&(DEBUG_BUILD$1?logger.enable():consoleSandbox((()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})));getCurrentScope().update(t.initialScope);const n=new e(t);return setCurrentClient(n),n.init(),n}function setCurrentClient(e){getCurrentScope().setClient(e)}function makePromiseBuffer(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]||Promise.resolve(void 0)}return{$:t,add:function(r){if(!(void 0===e||t.length<e))return rejectedSyncPromise(new SentryError("Not adding Promise because buffer limit was reached."));const s=r();return-1===t.indexOf(s)&&t.push(s),s.then((()=>n(s))).then(null,(()=>n(s).then(null,(()=>{})))),s},drain:function(e){return new SyncPromise(((n,r)=>{let s=t.length;if(!s)return n(!0);const o=setTimeout((()=>{e&&e>0&&n(!1)}),e);t.forEach((e=>{resolvedSyncPromise(e).then((()=>{--s||(clearTimeout(o),n(!0))}),r)}))}))}}}const DEFAULT_RETRY_AFTER=6e4;function parseRetryAfterHeader(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${e}`);return isNaN(r)?6e4:r-t}function disabledUntil(e,t){return e[t]||e.all||0}function isRateLimited(e,t,n=Date.now()){return disabledUntil(e,t)>n}function updateRateLimits(e,{statusCode:t,headers:n},r=Date.now()){const s={...e},o=n&&n["x-sentry-rate-limits"],i=n&&n["retry-after"];if(o)for(const e of o.trim().split(",")){const[t,n,,,o]=e.split(":",5),i=parseInt(t,10),a=1e3*(isNaN(i)?60:i);if(n)for(const e of n.split(";"))"metric_bucket"===e&&o&&!o.split(";").includes("custom")||(s[e]=r+a);else s.all=r+a}else i?s.all=r+parseRetryAfterHeader(i,r):429===t&&(s.all=r+6e4);return s}const DEFAULT_TRANSPORT_BUFFER_SIZE=64;function createTransport(e,t,n=makePromiseBuffer(e.bufferSize||64)){let r={};return{send:function(s){const o=[];if(forEachEnvelopeItem(s,((t,n)=>{const s=envelopeItemTypeToDataCategory(n);if(isRateLimited(r,s)){const r=getEventForEnvelopeItem(t,n);e.recordDroppedEvent("ratelimit_backoff",s,r)}else o.push(t)})),0===o.length)return resolvedSyncPromise({});const i=createEnvelope(s[0],o),a=t=>{forEachEnvelopeItem(i,((n,r)=>{const s=getEventForEnvelopeItem(n,r);e.recordDroppedEvent(t,envelopeItemTypeToDataCategory(r),s)}))};return n.add((()=>t({body:serializeEnvelope(i)}).then((e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&DEBUG_BUILD$1&&logger.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),r=updateRateLimits(r,e),e)),(e=>{throw a("network_error"),e})))).then((e=>e),(e=>{if(e instanceof SentryError)return DEBUG_BUILD$1&&logger.error("Skipped sending event because buffer is full."),a("queue_overflow"),resolvedSyncPromise({});throw e}))},flush:e=>n.drain(e)}}function getEventForEnvelopeItem(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}function getTraceData(e={}){const t=getClient();if(!isEnabled()||!t)return{};const n=getAsyncContextStrategy(getMainCarrier());if(n.getTraceData)return n.getTraceData(e);const r=getCurrentScope(),s=e.span||getActiveSpan(),o=s?spanToTraceHeader(s):scopeToTraceHeader(r),i=dynamicSamplingContextToSentryBaggageHeader(s?getDynamicSamplingContextFromSpan(s):getDynamicSamplingContextFromScope(t,r));return TRACEPARENT_REGEXP.test(o)?{"sentry-trace":o,baggage:i}:(logger.warn("Invalid sentry-trace data. Cannot generate trace data"),{})}function scopeToTraceHeader(e){const{traceId:t,sampled:n,spanId:r}=e.getPropagationContext();return generateSentryTraceHeader(t,r,n)}function getTraceMetaTags(){return Object.entries(getTraceData()).map((([e,t])=>`<meta name="${e}" content="${t}"/>`)).join("\n")}const DEFAULT_BREADCRUMBS=100;function addBreadcrumb(e,t){const n=getClient(),r=getIsolationScope();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:o=DEFAULT_BREADCRUMBS}=n.getOptions();if(o<=0)return;const i={timestamp:dateTimestampInSeconds(),...e},a=s?consoleSandbox((()=>s(i,t))):i;null!==a&&(n.emit&&n.emit("beforeAddBreadcrumb",a,t),r.addBreadcrumb(a,o))}let originalFunctionToString;const INTEGRATION_NAME$g="FunctionToString",SETUP_CLIENTS$1=new WeakMap,_functionToStringIntegration=()=>({name:"FunctionToString",setupOnce(){originalFunctionToString=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=getOriginalFunction(this),n=SETUP_CLIENTS$1.has(getClient())&&void 0!==t?t:this;return originalFunctionToString.apply(n,e)}}catch(e){}},setup(e){SETUP_CLIENTS$1.set(e,!0)}}),functionToStringIntegration=defineIntegration(_functionToStringIntegration),DEFAULT_IGNORE_ERRORS=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],INTEGRATION_NAME$f="InboundFilters",_inboundFiltersIntegration=(e={})=>({name:"InboundFilters",processEvent(t,n,r){const s=r.getOptions();return _shouldDropEvent$1(t,_mergeOptions(e,s))?null:t}}),inboundFiltersIntegration=defineIntegration(_inboundFiltersIntegration);function _mergeOptions(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:DEFAULT_IGNORE_ERRORS],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}function _shouldDropEvent$1(e,t){return t.ignoreInternal&&_isSentryError(e)?(DEBUG_BUILD$1&&logger.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${getEventDescription(e)}`),!0):_isIgnoredError(e,t.ignoreErrors)?(DEBUG_BUILD$1&&logger.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${getEventDescription(e)}`),!0):_isUselessError(e)?(DEBUG_BUILD$1&&logger.warn(`Event dropped due to not having an error message, error type or stacktrace.\nEvent: ${getEventDescription(e)}`),!0):_isIgnoredTransaction(e,t.ignoreTransactions)?(DEBUG_BUILD$1&&logger.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${getEventDescription(e)}`),!0):_isDeniedUrl(e,t.denyUrls)?(DEBUG_BUILD$1&&logger.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${getEventDescription(e)}.\nUrl: ${_getEventFilterUrl(e)}`),!0):!_isAllowedUrl(e,t.allowUrls)&&(DEBUG_BUILD$1&&logger.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${getEventDescription(e)}.\nUrl: ${_getEventFilterUrl(e)}`),!0)}function _isIgnoredError(e,t){return!(e.type||!t||!t.length)&&_getPossibleEventMessages(e).some((e=>stringMatchesSomePattern(e,t)))}function _isIgnoredTransaction(e,t){if("transaction"!==e.type||!t||!t.length)return!1;const n=e.transaction;return!!n&&stringMatchesSomePattern(n,t)}function _isDeniedUrl(e,t){if(!t||!t.length)return!1;const n=_getEventFilterUrl(e);return!!n&&stringMatchesSomePattern(n,t)}function _isAllowedUrl(e,t){if(!t||!t.length)return!0;const n=_getEventFilterUrl(e);return!n||stringMatchesSomePattern(n,t)}function _getPossibleEventMessages(e){const t=[];let n;e.message&&t.push(e.message);try{n=e.exception.values[e.exception.values.length-1]}catch(e){}return n&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`)),t}function _isSentryError(e){try{return"SentryError"===e.exception.values[0].type}catch(e){}return!1}function _getLastValidUrl(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}function _getEventFilterUrl(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch(e){}return t?_getLastValidUrl(t):null}catch(t){return DEBUG_BUILD$1&&logger.error(`Cannot extract url for event ${getEventDescription(e)}`),null}}function _isUselessError(e){return!e.type&&(!(!e.exception||!e.exception.values||0===e.exception.values.length)&&(!e.message&&!e.exception.values.some((e=>e.stacktrace||e.type&&"Error"!==e.type||e.value))))}function applyAggregateErrorsToEvent(e,t,n=250,r,s,o,i){if(!(o.exception&&o.exception.values&&i&&isInstanceOf(i.originalException,Error)))return;const a=o.exception.values.length>0?o.exception.values[o.exception.values.length-1]:void 0;a&&(o.exception.values=truncateAggregateExceptions(aggregateExceptionsFromError(e,t,s,i.originalException,r,o.exception.values,a,0),n))}function aggregateExceptionsFromError(e,t,n,r,s,o,i,a){if(o.length>=n+1)return o;let c=[...o];if(isInstanceOf(r[s],Error)){applyExceptionGroupFieldsForParentException(i,a);const o=e(t,r[s]),u=c.length;applyExceptionGroupFieldsForChildException(o,s,u,a),c=aggregateExceptionsFromError(e,t,n,r[s],s,[o,...c],o,u)}return Array.isArray(r.errors)&&r.errors.forEach(((r,o)=>{if(isInstanceOf(r,Error)){applyExceptionGroupFieldsForParentException(i,a);const u=e(t,r),l=c.length;applyExceptionGroupFieldsForChildException(u,`errors[${o}]`,l,a),c=aggregateExceptionsFromError(e,t,n,r,s,[u,...c],u,l)}})),c}function applyExceptionGroupFieldsForParentException(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,..."AggregateError"===e.type&&{is_exception_group:!0},exception_id:t}}function applyExceptionGroupFieldsForChildException(e,t,n,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}function truncateAggregateExceptions(e,t){return e.map((e=>(e.value&&(e.value=truncate(e.value,t)),e)))}const DEFAULT_KEY="cause",DEFAULT_LIMIT$1=5,INTEGRATION_NAME$e="LinkedErrors",_linkedErrorsIntegration=(e={})=>{const t=e.limit||5,n=e.key||"cause";return{name:"LinkedErrors",preprocessEvent(e,r,s){const o=s.getOptions();applyAggregateErrorsToEvent(exceptionFromError,o.stackParser,o.maxValueLength,n,t,e,r)}}},linkedErrorsIntegration=defineIntegration(_linkedErrorsIntegration);function parseCookie(e){const t={};let n=0;for(;n<e.length;){const r=e.indexOf("=",n);if(-1===r)break;let s=e.indexOf(";",n);if(-1===s)s=e.length;else if(s<r){n=e.lastIndexOf(";",r-1)+1;continue}const o=e.slice(n,r).trim();if(void 0===t[o]){let n=e.slice(r+1,s).trim();34===n.charCodeAt(0)&&(n=n.slice(1,-1));try{t[o]=-1!==n.indexOf("%")?decodeURIComponent(n):n}catch(e){t[o]=n}}n=s+1}return t}const ipHeaderNames=["X-Client-IP","X-Forwarded-For","Fly-Client-IP","CF-Connecting-IP","Fastly-Client-Ip","True-Client-Ip","X-Real-IP","X-Cluster-Client-IP","X-Forwarded","Forwarded-For","Forwarded","X-Vercel-Forwarded-For"];function getClientIPAddress(e){return ipHeaderNames.map((t=>{const n=e[t],r=Array.isArray(n)?n.join(";"):n;return"Forwarded"===t?parseForwardedHeader(r):r&&r.split(",").map((e=>e.trim()))})).reduce(((e,t)=>t?e.concat(t):e),[]).find((e=>null!==e&&isIP(e)))||null}function parseForwardedHeader(e){if(!e)return null;for(const t of e.split(";"))if(t.startsWith("for="))return t.slice(4);return null}function isIP(e){return/(?:^(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}$)|(?:^(?:(?:[a-fA-F\d]{1,4}:){7}(?:[a-fA-F\d]{1,4}|:)|(?:[a-fA-F\d]{1,4}:){6}(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|:[a-fA-F\d]{1,4}|:)|(?:[a-fA-F\d]{1,4}:){5}(?::(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,2}|:)|(?:[a-fA-F\d]{1,4}:){4}(?:(?::[a-fA-F\d]{1,4}){0,1}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,3}|:)|(?:[a-fA-F\d]{1,4}:){3}(?:(?::[a-fA-F\d]{1,4}){0,2}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,4}|:)|(?:[a-fA-F\d]{1,4}:){2}(?:(?::[a-fA-F\d]{1,4}){0,3}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,5}|:)|(?:[a-fA-F\d]{1,4}:){1}(?:(?::[a-fA-F\d]{1,4}){0,4}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,6}|:)|(?::(?:(?::[a-fA-F\d]{1,4}){0,5}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,7}|:)))(?:%[0-9a-zA-Z]{1,})?$)/.test(e)}const DEFAULT_INCLUDES={ip:!1,request:!0,user:!0},DEFAULT_REQUEST_INCLUDES=["cookies","data","headers","method","query_string","url"],DEFAULT_USER_INCLUDES=["id","username","email"];function extractUserData(e,t){const n={};return(Array.isArray(t)?t:DEFAULT_USER_INCLUDES).forEach((t=>{e&&t in e&&(n[t]=e[t])})),n}function extractRequestData(e,t={}){const{include:n=DEFAULT_REQUEST_INCLUDES}=t,r={},s=e.headers||{},o=e.method,i=s.host||e.hostname||e.host||"<no host>",a="https"===e.protocol||e.socket&&e.socket.encrypted?"https":"http",c=e.originalUrl||e.url||"",u=c.startsWith(a)?c:`${a}://${i}${c}`;return n.forEach((t=>{switch(t){case"headers":r.headers=s,n.includes("cookies")||delete r.headers.cookie,n.includes("ip")||ipHeaderNames.forEach((e=>{delete r.headers[e]}));break;case"method":r.method=o;break;case"url":r.url=u;break;case"cookies":r.cookies=e.cookies||s.cookie&&parseCookie(s.cookie)||{};break;case"query_string":r.query_string=extractQueryParams(e);break;case"data":{if("GET"===o||"HEAD"===o)break;const t=e.body;if(void 0!==t){const e=isString(t)?t:isPlainObject(t)?JSON.stringify(normalize(t)):truncate(`${t}`,1024);e&&(r.data=e)}break}default:({}).hasOwnProperty.call(e,t)&&(r[t]=e[t])}})),r}function addNormalizedRequestDataToEvent(e,t,n,r){const s={...DEFAULT_INCLUDES,...r&&r.include};if(s.request){const n=Array.isArray(s.request)?[...s.request]:[...DEFAULT_REQUEST_INCLUDES];s.ip&&n.push("ip");const r=extractNormalizedRequestData(t,{include:n});e.request={...e.request,...r}}if(s.user){const t=n.user&&isPlainObject(n.user)?extractUserData(n.user,s.user):{};Object.keys(t).length&&(e.user={...t,...e.user})}if(s.ip){const r=t.headers&&getClientIPAddress(t.headers)||n.ipAddress;r&&(e.user={...e.user,ip_address:r})}}function addRequestDataToEvent(e,t,n){const r={...DEFAULT_INCLUDES,...n&&n.include};if(r.request){const n=Array.isArray(r.request)?[...r.request]:[...DEFAULT_REQUEST_INCLUDES];r.ip&&n.push("ip");const s=extractRequestData(t,{include:n});e.request={...e.request,...s}}if(r.user){const n=t.user&&isPlainObject(t.user)?extractUserData(t.user,r.user):{};Object.keys(n).length&&(e.user={...e.user,...n})}if(r.ip){const n=t.headers&&getClientIPAddress(t.headers)||t.ip||t.socket&&t.socket.remoteAddress;n&&(e.user={...e.user,ip_address:n})}return e}function extractQueryParams(e){let t=e.originalUrl||e.url||"";if(t){t.startsWith("/")&&(t=`http://dogs.are.great${t}`);try{const n=e.query||new URL(t).search.slice(1);return n.length?n:void 0}catch(e){return}}}function extractNormalizedRequestData(e,{include:t}){const n=t?Array.isArray(t)?t:DEFAULT_REQUEST_INCLUDES:[],r={},s={...e.headers};if(n.includes("headers")&&(r.headers=s,t.includes("cookies")||delete s.cookie,t.includes("ip")||ipHeaderNames.forEach((e=>{delete s[e]}))),n.includes("method")&&(r.method=e.method),n.includes("url")&&(r.url=e.url),n.includes("cookies")){const t=e.cookies||(s&&s.cookie?parseCookie(s.cookie):void 0);r.cookies=t||{}}return n.includes("query_string")&&(r.query_string=e.query_string),n.includes("data")&&(r.data=e.data),r}const DEFAULT_OPTIONS={include:{cookies:!0,data:!0,headers:!0,ip:!1,query_string:!0,url:!0,user:{id:!0,username:!0,email:!0}},transactionNamingScheme:"methodPath"},INTEGRATION_NAME$d="RequestData",_requestDataIntegration=(e={})=>{const t={...DEFAULT_OPTIONS,...e,include:{...DEFAULT_OPTIONS.include,...e.include,user:e.include&&"boolean"==typeof e.include.user?e.include.user:{...DEFAULT_OPTIONS.include.user,...(e.include||{}).user}}};return{name:"RequestData",processEvent(e){const{sdkProcessingMetadata:n={}}=e,{request:r,normalizedRequest:s}=n,o=convertReqDataIntegrationOptsToAddReqDataOpts(t);if(s){return addNormalizedRequestDataToEvent(e,s,{ipAddress:r?r.ip||r.socket&&r.socket.remoteAddress:void 0,user:r?r.user:void 0},o),e}return r?addRequestDataToEvent(e,r,o):e}}},requestDataIntegration=defineIntegration(_requestDataIntegration);function convertReqDataIntegrationOptsToAddReqDataOpts(e){const{transactionNamingScheme:t,include:{ip:n,user:r,...s}}=e,o=["method"];for(const[e,t]of Object.entries(s))t&&o.push(e);let i;if(void 0===r)i=!0;else if("boolean"==typeof r)i=r;else{const e=[];for(const[t,n]of Object.entries(r))n&&e.push(t);i=e}return{include:{ip:n,user:i,request:0!==o.length?o:void 0,transaction:t}}}function addConsoleInstrumentationHandler(e){const t="console";addHandler(t,e),maybeInstrument(t,instrumentConsole)}function instrumentConsole(){"console"in GLOBAL_OBJ&&CONSOLE_LEVELS.forEach((function(e){e in GLOBAL_OBJ.console&&fill(GLOBAL_OBJ.console,e,(function(t){return originalConsoleMethods[e]=t,function(...t){triggerHandlers("console",{args:t,level:e});const n=originalConsoleMethods[e];n&&n.apply(GLOBAL_OBJ.console,t)}}))}))}function severityLevelFromString(e){return"warn"===e?"warning":["fatal","error","warning","log","info","debug"].includes(e)?e:"log"}const INTEGRATION_NAME$c="CaptureConsole",_captureConsoleIntegration=(e={})=>{const t=e.levels||CONSOLE_LEVELS,n=!!e.handled;return{name:"CaptureConsole",setup(e){"console"in GLOBAL_OBJ&&addConsoleInstrumentationHandler((({args:r,level:s})=>{getClient()===e&&t.includes(s)&&consoleHandler(r,s,n)}))}}},captureConsoleIntegration=defineIntegration(_captureConsoleIntegration);function consoleHandler(e,t,n){const r={level:severityLevelFromString(t),extra:{arguments:e}};withScope((s=>{if(s.addEventProcessor((e=>(e.logger="console",addExceptionMechanism(e,{handled:n,type:"console"}),e))),"assert"===t){if(!e[0]){const t=`Assertion failed: ${safeJoin(e.slice(1)," ")||"console.assert"}`;s.setExtra("arguments",e.slice(1)),captureMessage(t,r)}return}const o=e.find((e=>e instanceof Error));if(o)return void captureException(o,r);captureMessage(safeJoin(e," "),r)}))}const INTEGRATION_NAME$b="Debug",_debugIntegration=(e={})=>{const t={debugger:!1,stringify:!1,...e};return{name:"Debug",setup(e){e.on("beforeSendEvent",((e,n)=>{t.debugger,consoleSandbox((()=>{t.stringify?(console.log(JSON.stringify(e,null,2)),n&&Object.keys(n).length&&console.log(JSON.stringify(n,null,2))):(console.log(e),n&&Object.keys(n).length&&console.log(n))}))}))}}},debugIntegration=defineIntegration(_debugIntegration),INTEGRATION_NAME$a="Dedupe",_dedupeIntegration=()=>{let e;return{name:"Dedupe",processEvent(t){if(t.type)return t;try{if(_shouldDropEvent(t,e))return DEBUG_BUILD$1&&logger.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(e){}return e=t}}},dedupeIntegration=defineIntegration(_dedupeIntegration);function _shouldDropEvent(e,t){return!!t&&(!!_isSameMessageEvent(e,t)||!!_isSameExceptionEvent(e,t))}function _isSameMessageEvent(e,t){const n=e.message,r=t.message;return!(!n&&!r)&&(!(n&&!r||!n&&r)&&(n===r&&(!!_isSameFingerprint(e,t)&&!!_isSameStacktrace(e,t))))}function _isSameExceptionEvent(e,t){const n=_getExceptionFromEvent(t),r=_getExceptionFromEvent(e);return!(!n||!r)&&(n.type===r.type&&n.value===r.value&&(!!_isSameFingerprint(e,t)&&!!_isSameStacktrace(e,t)))}function _isSameStacktrace(e,t){let n=getFramesFromEvent(e),r=getFramesFromEvent(t);if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++){const t=r[e],s=n[e];if(t.filename!==s.filename||t.lineno!==s.lineno||t.colno!==s.colno||t.function!==s.function)return!1}return!0}function _isSameFingerprint(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return!(n.join("")!==r.join(""))}catch(e){return!1}}function _getExceptionFromEvent(e){return e.exception&&e.exception.values&&e.exception.values[0]}const INTEGRATION_NAME$9="ExtraErrorData",_extraErrorDataIntegration=(e={})=>{const{depth:t=3,captureErrorCause:n=!0}=e;return{name:"ExtraErrorData",processEvent(e,r,s){const{maxValueLength:o=250}=s.getOptions();return _enhanceEventWithErrorData(e,r,t,n,o)}}},extraErrorDataIntegration=defineIntegration(_extraErrorDataIntegration);function _enhanceEventWithErrorData(e,t={},n,r,s){if(!t.originalException||!isError(t.originalException))return e;const o=t.originalException.name||t.originalException.constructor.name,i=_extractErrorData(t.originalException,r,s);if(i){const t={...e.contexts},r=normalize(i,n);return isPlainObject(r)&&(addNonEnumerableProperty(r,"__sentry_skip_normalization__",!0),t[o]=r),{...e,contexts:t}}return e}function _extractErrorData(e,t,n){try{const r=["name","message","stack","line","column","fileName","lineNumber","columnNumber","toJSON"],s={};for(const t of Object.keys(e)){if(-1!==r.indexOf(t))continue;const o=e[t];s[t]=isError(o)||"string"==typeof o?truncate(`${o}`,n):o}if(t&&void 0!==e.cause&&(s.cause=isError(e.cause)?e.cause.toString():e.cause),"function"==typeof e.toJSON){const t=e.toJSON();for(const e of Object.keys(t)){const n=t[e];s[e]=isError(n)?n.toString():n}}return s}catch(e){DEBUG_BUILD$1&&logger.error("Unable to extract extra data from the Error object:",e)}return null}function normalizeArray(e,t){let n=0;for(let t=e.length-1;t>=0;t--){const r=e[t];"."===r?e.splice(t,1):".."===r?(e.splice(t,1),n++):n&&(e.splice(t,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}const splitPathRe=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function splitPath(e){const t=e.length>1024?`<truncated>${e.slice(-1024)}`:e,n=splitPathRe.exec(t);return n?n.slice(1):[]}function resolve(...e){let t="",n=!1;for(let r=e.length-1;r>=-1&&!n;r--){const s=r>=0?e[r]:"/";s&&(t=`${s}/${t}`,n="/"===s.charAt(0))}return t=normalizeArray(t.split("/").filter((e=>!!e)),!n).join("/"),(n?"/":"")+t||"."}function trim(e){let t=0;for(;t<e.length&&""===e[t];t++);let n=e.length-1;for(;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}function relative(e,t){e=resolve(e).slice(1),t=resolve(t).slice(1);const n=trim(e.split("/")),r=trim(t.split("/")),s=Math.min(n.length,r.length);let o=s;for(let e=0;e<s;e++)if(n[e]!==r[e]){o=e;break}let i=[];for(let e=o;e<n.length;e++)i.push("..");return i=i.concat(r.slice(o)),i.join("/")}function dirname(e){const t=splitPath(e),n=t[0]||"";let r=t[1];return n||r?(r&&(r=r.slice(0,r.length-1)),n+r):"."}function basename(e,t){return splitPath(e)[2]||""}const INTEGRATION_NAME$8="RewriteFrames",rewriteFramesIntegration=defineIntegration(((e={})=>{const t=e.root,n=e.prefix||"app:///",r="window"in GLOBAL_OBJ&&void 0!==GLOBAL_OBJ.window,s=e.iteratee||generateIteratee({isBrowser:r,root:t,prefix:n});return{name:"RewriteFrames",processEvent(e){let t=e;return e.exception&&Array.isArray(e.exception.values)&&(t=function(e){try{return{...e,exception:{...e.exception,values:e.exception.values.map((e=>{return{...e,...e.stacktrace&&{stacktrace:(t=e.stacktrace,{...t,frames:t&&t.frames&&t.frames.map((e=>s(e)))})}};var t}))}}}catch(t){return e}}(t)),t}}}));function generateIteratee({isBrowser:e,root:t,prefix:n}){return r=>{if(!r.filename)return r;const s=/^[a-zA-Z]:\\/.test(r.filename)||r.filename.includes("\\")&&!r.filename.includes("/"),o=/^\//.test(r.filename);if(e){if(t){const e=r.filename;0===e.indexOf(t)&&(r.filename=e.replace(t,n))}}else if(s||o){const e=s?r.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):r.filename,o=t?relative(t,e):basename(e);r.filename=`${n}${o}`}return r}}const INTEGRATION_NAME$7="SessionTiming",_sessionTimingIntegration=()=>{const e=1e3*timestampInSeconds();return{name:"SessionTiming",processEvent(t){const n=1e3*timestampInSeconds();return{...t,extra:{...t.extra,"session:start":e,"session:duration":n-e,"session:end":n}}}}},sessionTimingIntegration=defineIntegration(_sessionTimingIntegration),DEFAULT_LIMIT=10,INTEGRATION_NAME$6="ZodErrors";function originalExceptionIsZodError(e){return isError(e)&&"ZodError"===e.name&&Array.isArray(e.errors)}function formatIssueTitle(e){return{...e,path:"path"in e&&Array.isArray(e.path)?e.path.join("."):void 0,keys:"keys"in e?JSON.stringify(e.keys):void 0,unionErrors:"unionErrors"in e?JSON.stringify(e.unionErrors):void 0}}function formatIssueMessage(e){const t=new Set;for(const n of e.issues)n.path&&n.path[0]&&t.add(n.path[0]);return`Failed to validate keys: ${truncate(Array.from(t).join(", "),100)}`}function applyZodErrorsToEvent(e,t,n){return t.exception&&t.exception.values&&n&&n.originalException&&originalExceptionIsZodError(n.originalException)&&0!==n.originalException.issues.length?{...t,exception:{...t.exception,values:[{...t.exception.values[0],value:formatIssueMessage(n.originalException)},...t.exception.values.slice(1)]},extra:{...t.extra,"zoderror.issues":n.originalException.errors.slice(0,e).map(formatIssueTitle)}}:t}const _zodErrorsIntegration=(e={})=>{const t=e.limit||10;return{name:"ZodErrors",processEvent:(e,n)=>applyZodErrorsToEvent(t,e,n)}},zodErrorsIntegration=defineIntegration(_zodErrorsIntegration),COUNTER_METRIC_TYPE="c",GAUGE_METRIC_TYPE="g",SET_METRIC_TYPE="s",DISTRIBUTION_METRIC_TYPE="d",DEFAULT_FLUSH_INTERVAL=1e4,MAX_WEIGHT=1e4;function getMetricsAggregatorForClient$1(e,t){const n=getGlobalSingleton("globalMetricsAggregators",(()=>new WeakMap)),r=n.get(e);if(r)return r;const s=new t(e);return e.on("flush",(()=>s.flush())),e.on("close",(()=>s.close())),n.set(e,s),s}function addToMetricsAggregator(e,t,n,r,s={}){const o=s.client||getClient();if(!o)return;const i=getActiveSpan(),a=i?getRootSpan(i):void 0,c=a&&spanToJSON(a).description,{unit:u,tags:l,timestamp:p}=s,{release:d,environment:g}=o.getOptions(),m={};d&&(m.release=d),g&&(m.environment=g),c&&(m.transaction=c),DEBUG_BUILD$1&&logger.log(`Adding value of ${r} to ${t} metric ${n}`);getMetricsAggregatorForClient$1(o,e).add(t,n,r,u,{...m,...l},p)}function increment$1(e,t,n=1,r){addToMetricsAggregator(e,"c",t,ensureNumber(n),r)}function distribution$1(e,t,n,r){addToMetricsAggregator(e,"d",t,ensureNumber(n),r)}function timing$1(e,t,n,r="second",s){if("function"==typeof n){const r=timestampInSeconds();return startSpanManual({op:"metrics.timing",name:t,startTime:r,onlyIfParent:!0},(o=>handleCallbackErrors((()=>n()),(()=>{}),(()=>{const n=timestampInSeconds();distribution$1(e,t,n-r,{...s,unit:"second"}),o.end(n)}))))}distribution$1(e,t,n,{...s,unit:r})}function set$1(e,t,n,r){addToMetricsAggregator(e,"s",t,n,r)}function gauge$1(e,t,n,r){addToMetricsAggregator(e,"g",t,ensureNumber(n),r)}const metrics={increment:increment$1,distribution:distribution$1,set:set$1,gauge:gauge$1,timing:timing$1,getMetricsAggregatorForClient:getMetricsAggregatorForClient$1};function ensureNumber(e){return"string"==typeof e?parseInt(e):e}function getBucketKey(e,t,n,r){return`${e}${t}${n}${Object.entries(dropUndefinedKeys(r)).sort(((e,t)=>e[0].localeCompare(t[0])))}`}function simpleHash(e){let t=0;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t>>>0}function serializeMetricBuckets(e){let t="";for(const n of e){const e=Object.entries(n.tags),r=e.length>0?`|#${e.map((([e,t])=>`${e}:${t}`)).join(",")}`:"";t+=`${n.name}@${n.unit}:${n.metric}|${n.metricType}${r}|T${n.timestamp}\n`}return t}function sanitizeUnit(e){return e.replace(/[^\w]+/gi,"_")}function sanitizeMetricKey(e){return e.replace(/[^\w\-.]+/gi,"_")}function sanitizeTagKey(e){return e.replace(/[^\w\-./]+/gi,"")}const tagValueReplacements=[["\n","\\n"],["\r","\\r"],["\t","\\t"],["\\","\\\\"],["|","\\u{7c}"],[",","\\u{2c}"]];function getCharOrReplacement(e){for(const[t,n]of tagValueReplacements)if(e===t)return n;return e}function sanitizeTagValue(e){return[...e].reduce(((e,t)=>e+getCharOrReplacement(t)),"")}function sanitizeTags(e){const t={};for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){t[sanitizeTagKey(n)]=sanitizeTagValue(String(e[n]))}return t}function captureAggregateMetrics(e,t){logger.log(`Flushing aggregated metrics, number of metrics: ${t.length}`);const n=createMetricEnvelope(t,e.getDsn(),e.getSdkMetadata(),e.getOptions().tunnel);e.sendEnvelope(n)}function createMetricEnvelope(e,t,n,r){const s={sent_at:(new Date).toISOString()};n&&n.sdk&&(s.sdk={name:n.sdk.name,version:n.sdk.version}),r&&t&&(s.dsn=dsnToString(t));return createEnvelope(s,[createMetricEnvelopeItem(e)])}function createMetricEnvelopeItem(e){const t=serializeMetricBuckets(e);return[{type:"statsd",length:t.length},t]}class CounterMetric{constructor(e){this._value=e}get weight(){return 1}add(e){this._value+=e}toString(){return`${this._value}`}}class GaugeMetric{constructor(e){this._last=e,this._min=e,this._max=e,this._sum=e,this._count=1}get weight(){return 5}add(e){this._last=e,e<this._min&&(this._min=e),e>this._max&&(this._max=e),this._sum+=e,this._count++}toString(){return`${this._last}:${this._min}:${this._max}:${this._sum}:${this._count}`}}class DistributionMetric{constructor(e){this._value=[e]}get weight(){return this._value.length}add(e){this._value.push(e)}toString(){return this._value.join(":")}}class SetMetric{constructor(e){this.first=e,this._value=new Set([e])}get weight(){return this._value.size}add(e){this._value.add(e)}toString(){return Array.from(this._value).map((e=>"string"==typeof e?simpleHash(e):e)).join(":")}}const METRIC_MAP={[COUNTER_METRIC_TYPE]:CounterMetric,[GAUGE_METRIC_TYPE]:GaugeMetric,[DISTRIBUTION_METRIC_TYPE]:DistributionMetric,[SET_METRIC_TYPE]:SetMetric};class MetricsAggregator{constructor(e){this._client=e,this._buckets=new Map,this._bucketsTotalWeight=0,this._interval=setInterval((()=>this._flush()),1e4),this._interval.unref&&this._interval.unref(),this._flushShift=Math.floor(1e4*Math.random()/1e3),this._forceFlush=!1}add(e,t,n,r="none",s={},o=timestampInSeconds()){const i=Math.floor(o),a=sanitizeMetricKey(t),c=sanitizeTags(s),u=sanitizeUnit(r),l=getBucketKey(e,a,u,c);let p=this._buckets.get(l);const d=p&&"s"===e?p.metric.weight:0;p?(p.metric.add(n),p.timestamp<i&&(p.timestamp=i)):(p={metric:new METRIC_MAP[e](n),timestamp:i,metricType:e,name:a,unit:u,tags:c},this._buckets.set(l,p));updateMetricSummaryOnActiveSpan(e,a,"string"==typeof n?p.metric.weight-d:n,u,s,l),this._bucketsTotalWeight+=p.metric.weight,this._bucketsTotalWeight>=1e4&&this.flush()}flush(){this._forceFlush=!0,this._flush()}close(){this._forceFlush=!0,clearInterval(this._interval),this._flush()}_flush(){if(this._forceFlush)return this._forceFlush=!1,this._bucketsTotalWeight=0,this._captureMetrics(this._buckets),void this._buckets.clear();const e=Math.floor(timestampInSeconds())-10-this._flushShift,t=new Map;for(const[n,r]of this._buckets)r.timestamp<=e&&(t.set(n,r),this._bucketsTotalWeight-=r.metric.weight);for(const[e]of t)this._buckets.delete(e);this._captureMetrics(t)}_captureMetrics(e){if(e.size>0){const t=Array.from(e).map((([,e])=>e));captureAggregateMetrics(this._client,t)}}}function increment(e,t=1,n){metrics.increment(MetricsAggregator,e,t,n)}function distribution(e,t,n){metrics.distribution(MetricsAggregator,e,t,n)}function set(e,t,n){metrics.set(MetricsAggregator,e,t,n)}function gauge(e,t,n){metrics.gauge(MetricsAggregator,e,t,n)}function timing(e,t,n="second",r){return metrics.timing(MetricsAggregator,e,t,n,r)}function getMetricsAggregatorForClient(e){return metrics.getMetricsAggregatorForClient(e,MetricsAggregator)}const metricsDefault={increment:increment,distribution:distribution,set:set,gauge:gauge,timing:timing,getMetricsAggregatorForClient:getMetricsAggregatorForClient};function captureFeedback(e,t={},n=getCurrentScope()){const{message:r,name:s,email:o,url:i,source:a,associatedEventId:c,tags:u}=e,l={contexts:{feedback:dropUndefinedKeys({contact_email:o,name:s,message:r,url:i,source:a,associated_event_id:c})},type:"feedback",level:"info",tags:u},p=n&&n.getClient()||getClient();p&&p.emit("beforeSendFeedback",l,t);return n.captureEvent(l,t)}function getBreadcrumbLogLevelFromHttpStatusCode(e){return void 0===e?void 0:e>=400&&e<500?"warning":e>=500?"error":void 0}const WINDOW=GLOBAL_OBJ;function supportsFetch(){if(!("fetch"in WINDOW))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}function isNativeFunction(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function supportsNativeFetch(){if("string"==typeof EdgeRuntime)return!0;if(!supportsFetch())return!1;if(isNativeFunction(WINDOW.fetch))return!0;let e=!1;const t=WINDOW.document;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=isNativeFunction(n.contentWindow.fetch)),t.head.removeChild(n)}catch(e){DEBUG_BUILD&&logger.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e}function addFetchInstrumentationHandler(e,t){const n="fetch";addHandler(n,e),maybeInstrument(n,(()=>instrumentFetch(void 0,t)))}function instrumentFetch(e,t=!1){t&&!supportsNativeFetch()||fill(GLOBAL_OBJ,"fetch",(function(e){return function(...t){const n=new Error,{method:r,url:s}=parseFetchArgs(t),o={args:t,fetchData:{method:r,url:s},startTimestamp:1e3*timestampInSeconds(),virtualError:n};return triggerHandlers("fetch",{...o}),e.apply(GLOBAL_OBJ,t).then((async e=>(triggerHandlers("fetch",{...o,endTimestamp:1e3*timestampInSeconds(),response:e}),e)),(e=>{throw triggerHandlers("fetch",{...o,endTimestamp:1e3*timestampInSeconds(),error:e}),isError(e)&&void 0===e.stack&&(e.stack=n.stack,addNonEnumerableProperty(e,"framesToPop",1)),e}))}}))}function hasProp(e,t){return!!e&&"object"==typeof e&&!!e[t]}function getUrlFromResource(e){return"string"==typeof e?e:e?hasProp(e,"url")?e.url:e.toString?e.toString():"":""}function parseFetchArgs(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:getUrlFromResource(t),method:hasProp(n,"method")?String(n.method).toUpperCase():"GET"}}const t=e[0];return{url:getUrlFromResource(t),method:hasProp(t,"method")?String(t.method).toUpperCase():"GET"}}function filenameIsInApp(e,t=!1){return!(t||e&&!e.startsWith("/")&&!e.match(/^[A-Z]:/)&&!e.startsWith(".")&&!e.match(/^[a-zA-Z]([a-zA-Z0-9.\-+])*:\/\//))&&void 0!==e&&!e.includes("node_modules/")}function node(e){const t=/^\s*[-]{4,}$/,n=/at (?:async )?(?:(.+?)\s+\()?(?:(.+):(\d+):(\d+)?|([^)]+))\)?/;return r=>{const s=r.match(n);if(s){let t,n,r,o,i;if(s[1]){r=s[1];let e=r.lastIndexOf(".");if("."===r[e-1]&&e--,e>0){t=r.slice(0,e),n=r.slice(e+1);const s=t.indexOf(".Module");s>0&&(r=r.slice(s+1),t=t.slice(0,s))}o=void 0}n&&(o=t,i=n),"<anonymous>"===n&&(i=void 0,r=void 0),void 0===r&&(i=i||"?",r=o?`${o}.${i}`:i);let a=s[2]&&s[2].startsWith("file://")?s[2].slice(7):s[2];const c="native"===s[5];return a&&a.match(/\/[A-Z]:/)&&(a=a.slice(1)),a||!s[5]||c||(a=s[5]),{filename:a?decodeURI(a):void 0,module:e?e(a):void 0,function:r,lineno:_parseIntOrUndefined(s[3]),colno:_parseIntOrUndefined(s[4]),in_app:filenameIsInApp(a||"",c)}}if(r.match(t))return{filename:r}}}function nodeStackLineParser(e){return[90,node(e)]}function _parseIntOrUndefined(e){return parseInt(e||"",10)||void 0}class LRUMap{constructor(e){this._maxSize=e,this._cache=new Map}get size(){return this._cache.size}get(e){const t=this._cache.get(e);if(void 0!==t)return this._cache.delete(e),this._cache.set(e,t),t}set(e,t){this._cache.size>=this._maxSize&&this._cache.delete(this._cache.keys().next().value),this._cache.set(e,t)}remove(e){const t=this._cache.get(e);return t&&this._cache.delete(e),t}clear(){this._cache.clear()}keys(){return Array.from(this._cache.keys())}values(){const e=[];return this._cache.forEach((t=>e.push(t))),e}}function getHostName(){if(!Deno.permissions.querySync)return;return"granted"===Deno.permissions.querySync({name:"sys",kind:"hostname"}).state?Deno.hostname():void 0}class DenoClient extends ServerRuntimeClient{constructor(e){e._metadata=e._metadata||{},e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.deno",packages:[{name:"denoland:sentry",version:"8.50.0"}],version:"8.50.0"};super({...e,platform:"javascript",runtime:{name:"deno",version:Deno.version.deno},serverName:e.serverName||getHostName()})}}const INTEGRATION_NAME$5="Breadcrumbs",_breadcrumbsIntegration=(e={})=>{const t={console:!0,fetch:!0,sentry:!0,...e};return{name:"Breadcrumbs",setup(e){t.console&&addConsoleInstrumentationHandler(_getConsoleBreadcrumbHandler(e)),t.fetch&&addFetchInstrumentationHandler(_getFetchBreadcrumbHandler(e)),t.sentry&&e.on("beforeSendEvent",_getSentryBreadcrumbHandler(e))}}},breadcrumbsIntegration=defineIntegration(_breadcrumbsIntegration);function _getSentryBreadcrumbHandler(e){return function(t){getClient()===e&&addBreadcrumb({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:getEventDescription(t)},{event:t})}}function _getConsoleBreadcrumbHandler(e){return function(t){if(getClient()!==e)return;const n={category:"console",data:{arguments:t.args,logger:"console"},level:severityLevelFromString(t.level),message:safeJoin(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;n.message=`Assertion failed: ${safeJoin(t.args.slice(1)," ")||"console.assert"}`,n.data.arguments=t.args.slice(1)}addBreadcrumb(n,{input:t.args,level:t.level})}}function _getFetchBreadcrumbHandler(e){return function(t){if(getClient()!==e)return;const{startTimestamp:n,endTimestamp:r}=t;if(r&&(!t.fetchData.url.match(/sentry_key/)||"POST"!==t.fetchData.method))if(t.error){addBreadcrumb({category:"fetch",data:t.fetchData,level:"error",type:"http"},{data:t.error,input:t.args,startTimestamp:n,endTimestamp:r})}else{const e=t.response,s={...t.fetchData,status_code:e&&e.status},o={input:t.args,response:e,startTimestamp:n,endTimestamp:r};addBreadcrumb({category:"fetch",data:s,type:"http",level:getBreadcrumbLogLevelFromHttpStatusCode(s.status_code)},o)}}}const INTEGRATION_NAME$4="DenoContext";function getOSName(){switch(Deno.build.os){case"darwin":return"macOS";case"linux":return"Linux";case"windows":return"Windows";default:return Deno.build.os}}async function getOSRelease(){return"granted"===(await Deno.permissions.query({name:"sys",kind:"osRelease"})).state?Deno.osRelease():void 0}async function addDenoRuntimeContext(e){return e.contexts={app:{app_start_time:new Date(Date.now()-performance.now()).toISOString()},device:{arch:Deno.build.arch,processor_count:navigator.hardwareConcurrency},os:{name:getOSName(),version:await getOSRelease()},v8:{name:"v8",version:Deno.version.v8},typescript:{name:"TypeScript",version:Deno.version.typescript},...e.contexts},e}const _denoContextIntegration=()=>({name:"DenoContext",processEvent:e=>addDenoRuntimeContext(e)}),denoContextIntegration=defineIntegration(_denoContextIntegration),INTEGRATION_NAME$3="ContextLines",FILE_CONTENT_CACHE=new LRUMap(100),DEFAULT_LINES_OF_CONTEXT=7;async function readSourceFile(e){const t=FILE_CONTENT_CACHE.get(e);if(void 0!==t)return t;let n=null;try{n=await Deno.readTextFile(e)}catch(e){}return FILE_CONTENT_CACHE.set(e,n),n}const _contextLinesIntegration=(e={})=>{const t=void 0!==e.frameContextLines?e.frameContextLines:7;return{name:"ContextLines",processEvent:e=>addSourceContext(e,t)}},contextLinesIntegration=defineIntegration(_contextLinesIntegration);async function addSourceContext(e,t){if(t>0&&e.exception&&e.exception.values)for(const n of e.exception.values)n.stacktrace&&n.stacktrace.frames&&await addSourceContextToFrames(n.stacktrace.frames,t);return e}async function addSourceContextToFrames(e,t){for(const n of e)if(n.filename&&n.in_app&&void 0===n.context_line){if("granted"==(await Deno.permissions.query({name:"read",path:n.filename})).state){const e=await readSourceFile(n.filename);if(e)try{addContextToFrame(e.split("\n"),n,t)}catch(e){}}}}const INTEGRATION_NAME$2="GlobalHandlers";let isExiting=!1;const _globalHandlersIntegration=e=>{const t={error:!0,unhandledrejection:!0,...e};return{name:"GlobalHandlers",setup(e){t.error&&installGlobalErrorHandler(e),t.unhandledrejection&&installGlobalUnhandledRejectionHandler(e)}}},globalHandlersIntegration=defineIntegration(_globalHandlersIntegration);function installGlobalErrorHandler(e){globalThis.addEventListener("error",(t=>{if(getClient()!==e||isExiting)return;const n=getStackParser(),{message:r,error:s}=t,o=eventFromUnknownInput(e,n,s||r);o.level="fatal",captureEvent(o,{originalException:s,mechanism:{handled:!1,type:"error"}}),t.preventDefault(),isExiting=!0,flush().then((()=>{throw s}),(()=>{throw s}))}))}function installGlobalUnhandledRejectionHandler(e){globalThis.addEventListener("unhandledrejection",(t=>{if(getClient()!==e||isExiting)return;const n=getStackParser();let r=t;try{"reason"in t&&(r=t.reason)}catch(e){}const s=isPrimitive(r)?eventFromRejectionWithPrimitive(r):eventFromUnknownInput(e,n,r,void 0);s.level="fatal",captureEvent(s,{originalException:r,mechanism:{handled:!1,type:"unhandledrejection"}}),t.preventDefault(),isExiting=!0,flush().then((()=>{throw r}),(()=>{throw r}))}))}function eventFromRejectionWithPrimitive(e){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(e)}`}]}}}function getStackParser(){const e=getClient();return e?e.getOptions().stackParser:()=>[]}function _optionalChain(e){let t,n=e[0],r=1;for(;r<e.length;){const s=e[r],o=e[r+1];if(r+=2,("optionalAccess"===s||"optionalCall"===s)&&null==n)return;"access"===s||"optionalAccess"===s?(t=n,n=o(n)):"call"!==s&&"optionalCall"!==s||(n=o(((...e)=>n.call(t,...e))),t=void 0)}return n}const INTEGRATION_NAME$1="NormalizePaths";function appRootFromErrorStack(e){const t=createStackParser(nodeStackLineParser())(e.stack||"").filter((e=>e.in_app&&e.filename)).map((e=>e.filename.replace(/^[A-Z]:/,"").replace(/\\/g,"/").split("/").filter((e=>""!==e)))),n=t[0];if(!n)return;if(1==t.length)return dirname(n.join("/"));let r=0;for(;n[r]&&t.every((e=>e[r]===n[r]));)r++;return n.slice(0,r).join("/")}function getCwd(){if(!Deno.permissions.querySync)return;const e=Deno.permissions.querySync({name:"read",path:"./"});try{if("granted"==e.state)return Deno.cwd()}catch(e){}}const _normalizePathsIntegration=()=>{let e;function t(t){return void 0===e&&(e=getCwd()||appRootFromErrorStack(t)),e}return{name:"NormalizePaths",processEvent(e){const n=t(new Error);if(n)for(const t of _optionalChain([e,"access",e=>e.exception,"optionalAccess",e=>e.values])||[])for(const e of _optionalChain([t,"access",e=>e.stacktrace,"optionalAccess",e=>e.frames])||[])if(e.filename&&e.in_app){const t=e.filename.indexOf(n);if(t>-1){const r=t+n.length;e.filename=`app://${e.filename.substring(r)}`}}return e}}},normalizePathsIntegration=defineIntegration(_normalizePathsIntegration);function makeFetchTransport(e){const t=new URL(e.url);return Deno.permissions.query({name:"net",host:t.host}).then((({state:e})=>{"granted"!==e&&consoleSandbox((()=>{console.warn(`Sentry SDK requires 'net' permission to send events.\n    Run with '--allow-net=${t.host}' to grant the requires permissions.`)}))})).catch((()=>{logger.warn('Failed to read the "net" permission.')})),createTransport(e,(function(t){const n={body:t.body,method:"POST",referrerPolicy:"origin",headers:e.headers};try{return suppressTracing((()=>fetch(e.url,n).then((e=>({statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}})))))}catch(e){return rejectedSyncPromise(e)}}))}function getDefaultIntegrations(e){return[inboundFiltersIntegration(),functionToStringIntegration(),linkedErrorsIntegration(),dedupeIntegration(),breadcrumbsIntegration(),denoContextIntegration(),contextLinesIntegration(),normalizePathsIntegration(),globalHandlersIntegration()]}const defaultStackParser=createStackParser(nodeStackLineParser());function init(e={}){void 0===e.defaultIntegrations&&(e.defaultIntegrations=getDefaultIntegrations());const t={...e,stackParser:stackParserFromStackParserOptions(e.stackParser||defaultStackParser),integrations:getIntegrationsToSetup(e),transport:e.transport||makeFetchTransport};return initAndBind(DenoClient,t)}function formatToCronSchedule(e){if(void 0===e)return"*";if("number"==typeof e)return e.toString();{const{exact:t}=e;if(void 0===t){const{start:t,end:n,every:r}=e;if(void 0!==t&&void 0!==n&&void 0!==r)return`${t}-${n}/${r}`;if(void 0!==t&&void 0!==n)return`${t}-${n}`;if(void 0!==t&&void 0!==r)return`${t}/${r}`;if(void 0!==t)return`${t}/1`;if(void 0===n&&void 0!==r)return`*/${r}`;throw new TypeError("Invalid cron schedule")}return"number"==typeof t?t.toString():t.join(",")}}function parseScheduleToString(e){if("string"==typeof e)return e;{const{minute:t,hour:n,dayOfMonth:r,month:s,dayOfWeek:o}=e;return`${formatToCronSchedule(t)} ${formatToCronSchedule(n)} ${formatToCronSchedule(r)} ${formatToCronSchedule(s)} ${formatToCronSchedule(o)}`}}const INTEGRATION_NAME="DenoCron",SETUP_CLIENTS=new WeakMap,_denoCronIntegration=()=>({name:"DenoCron",setupOnce(){Deno.cron&&(Deno.cron=new Proxy(Deno.cron,{apply(e,t,n){const[r,s,o,i]=n;let a,c;return"function"==typeof o&&"function"!=typeof i?(c=o,a=i):"function"!=typeof o&&"function"==typeof i&&(c=i,a=o),e.call(t,r,s,a||{},(async function(){if(!SETUP_CLIENTS.has(getClient()))return c();await withMonitor(r,(async()=>c()),{schedule:{type:"crontab",value:parseScheduleToString(s)},maxRuntime:720,checkinMargin:1})}))}}))},setup(e){SETUP_CLIENTS.set(e,!0)}}),denoCronIntegration=defineIntegration(_denoCronIntegration);export{DenoClient,SDK_VERSION,SEMANTIC_ATTRIBUTE_SENTRY_OP,SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN,SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,Scope,addBreadcrumb,addEventProcessor,breadcrumbsIntegration,captureCheckIn,captureConsoleIntegration,captureEvent,captureException,captureFeedback,captureMessage,captureSession,close,contextLinesIntegration,continueTrace,createTransport,debugIntegration,dedupeIntegration,denoContextIntegration,denoCronIntegration,endSession,extraErrorDataIntegration,flush,functionToStringIntegration,getActiveSpan,getClient,getCurrentScope,getDefaultIntegrations,getGlobalScope,getIsolationScope,getRootSpan,getSpanStatusFromHttpCode,getTraceData,getTraceMetaTags,globalHandlersIntegration,inboundFiltersIntegration,init,isInitialized,lastEventId,linkedErrorsIntegration,metricsDefault as metrics,normalizePathsIntegration,requestDataIntegration,rewriteFramesIntegration,sessionTimingIntegration,setContext,setCurrentClient,setExtra,setExtras,setHttpStatus,setMeasurement,setTag,setTags,setUser,spanToBaggageHeader,spanToJSON,spanToTraceHeader,startInactiveSpan,startNewTrace,startSession,startSpan,startSpanManual,suppressTracing,updateSpanName,withIsolationScope,withMonitor,withScope,zodErrorsIntegration};